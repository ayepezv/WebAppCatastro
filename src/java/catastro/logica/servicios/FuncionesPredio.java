package catastro.logica.servicios;

import accesoDatos.AccesoDatos;
import catastro.coeficientes.funciones.FSectorHomogeneo;
import catastro.logica.entidades.Dominio;
import catastro.logica.entidades.Parroquia;
import catastro.logica.entidades.PredioV2;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import master.logica.entidades.Usuario;
import master.logica.servicios.ServiciosUsuario;

public class FuncionesPredio {

    public static ArrayList<PredioV2> seleccionarPredios() throws Exception {
        ArrayList<PredioV2> lst = new ArrayList<>();
        AccesoDatos accesoDatos;
        PredioV2 predio;
        ResultSet resultSet;
        String sql;
        try {
            accesoDatos = new AccesoDatos();
            sql = "SELECT * from catastro.f_seleccionar_predios_v2();";
            resultSet = accesoDatos.ejecutaQuery(sql);
            while (resultSet.next()) {
                predio = new PredioV2();
                predio.setIdParroquia(new Parroquia());
                predio.setPropietario(new Usuario());
                predio.setRepLegal(new Usuario());
                predio.setDominio(new Dominio());
                predio.setIdPredio(resultSet.getInt("int_id_predio"));
                predio.setNumFicha(resultSet.getInt("int_num_ficha"));
                predio.setIdParroquia(ServiciosParroquia.obtenerParroquiaDadoCodigo(resultSet.getInt("int_id_parroquia")));
                predio.setZona(resultSet.getInt("int_zona"));
                predio.setSector(resultSet.getInt("int_sector"));
                predio.setManzana(resultSet.getInt("int_manzana"));
                predio.setNumPredio(resultSet.getInt("int_num_predio"));
                predio.setPropHorBloque(resultSet.getInt("int_prop_hor_bloque"));
                predio.setPropHorPiso(resultSet.getInt("int_prop_hor_piso"));
                predio.setPropHorUnidad(resultSet.getInt("int_prop_hor_unidad"));
                predio.setClaveCatastral(resultSet.getString("chv_clave_catastral"));
                predio.setClaveCatastralAnt(resultSet.getString("chv_clave_catastral_ant"));
                predio.setBarrio(resultSet.getString("chv_barrio"));
                predio.setCallePrinc(resultSet.getString("chv_calle_princ"));
                predio.setCalleSecund(resultSet.getString("chv_calle_secund"));
                predio.setNumCasa(resultSet.getString("chv_num_casa"));
                predio.setNombreEdificio(resultSet.getString("chv_nombre_edificio"));
                predio.setPropietario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_titular_dom")));
                predio.setRepLegal(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_rep_legal")));
                predio.setDominio(ServiciosDominio.obtenerDominioDadoCodigo(resultSet.getInt("int_id_dominio")));
                predio.setCondicion(resultSet.getString("chv_condicion"));
                predio.setFormaAdq(resultSet.getString("chv_forma_adq"));
                predio.setNotaria(resultSet.getString("chv_notaria"));
                predio.setFechaTituloProp(resultSet.getDate("dt_fecha_titulo_prop"));
                predio.setFechaRegistroPredio(resultSet.getDate("dt_fecha_registro"));
                predio.setAreaEscritura(resultSet.getDouble("db_area_escritura"));
                predio.setPropAnterior(resultSet.getString("chv_prop_anterior"));
                predio.setAvaluoProp(resultSet.getDouble("db_avaluo_prop"));
                predio.setUsoSueloGestion(resultSet.getString("chv_gest_uso_suelo"));
                predio.setUsoSueloConsumo(resultSet.getString("chv_uso_suelo_consumo"));
                predio.setUsoSuelIntercambio(resultSet.getString("chv_us_suel_intercambio"));
                predio.setUsoSuelProduc(resultSet.getString("chv_us_suel_produc"));
                predio.setOcupacionPredio(resultSet.getString("chv_ocupacion_predio"));
                predio.setLocalizacionPredio(resultSet.getString("chv_localizacion_predio"));
                predio.setTopografiaPredio(resultSet.getString("chv_topografia_pedio"));
                predio.setFormaPredio(resultSet.getString("chv_forma_predio"));
                predio.setCaracteristSuelo(resultSet.getString("chv_caract_suelo"));
                predio.setUsoVias(resultSet.getString("chv_uso_vias"));
                predio.setMaterialVias(resultSet.getString("chv_material_vias"));
                predio.setRedAgua(resultSet.getString("chv_red_agua"));
                predio.setAlcantarillado(resultSet.getString("chv_alcantarillado"));
                predio.setEnergElectric(resultSet.getString("chv_energ_electric"));
                predio.setRedTelefon(resultSet.getString("chv_red_telefon"));
                predio.setRecBasura(resultSet.getString("chv_rec_basura"));
                predio.setTranspPublico(resultSet.getString("chv_transp_publico"));
                predio.setInternet(resultSet.getString("chv_internet"));
                predio.setOtrosServicios(resultSet.getString("chv_otros_servicios"));
                predio.setAreaConstruc(resultSet.getDouble("db_area_construc"));
                predio.setAreaTotalConst(resultSet.getDouble("db_area_total_const"));
                predio.setAreaTotalTerreno(resultSet.getDouble("db_area_total_terreno"));
                predio.setPatio(resultSet.getString("chv_patio"));
                predio.setPiscina(resultSet.getString("chv_piscina"));
                predio.setCerramiento(resultSet.getString("chv_cerramiento"));
                predio.setCisterna(resultSet.getString("chv_cisterna"));
                predio.setMuros(resultSet.getString("chv_muros"));
                predio.setAscensor(resultSet.getString("chv_ascensor"));
                predio.setNumBanios(resultSet.getInt("int_num_banios"));
                predio.setLinderoFrente1(resultSet.getDouble("db_lindero_frente1"));
                predio.setLinderoFrente2(resultSet.getDouble("db_lindero_frente2"));
                predio.setLinderoFrente3(resultSet.getDouble("db_lindero_frente3"));
                predio.setLinderoFrente4(resultSet.getDouble("db_lindero_frente4"));
                predio.setLinderoCalle1(resultSet.getString("chv_lindero_calle1"));
                predio.setLinderoCalle2(resultSet.getString("chv_lindero_calle2"));
                predio.setLinderoCalle3(resultSet.getString("chv_lindero_calle3"));
                predio.setLinderoCalle4(resultSet.getString("chv_lindero_calle4"));
                predio.setLinderoAlicuota1(resultSet.getDouble("db_lindero_alicuota1"));
                predio.setLinderoAlicuota2(resultSet.getDouble("db_lindero_alicuota2"));
                predio.setLinderoAlicuota3(resultSet.getDouble("db_lindero_alicuota3"));
                predio.setLinderoAlicuota4(resultSet.getDouble("db_lindero_alicuota4"));
                predio.setCroquis(resultSet.getString("chv_croquis"));
                predio.setEmplazamiento(resultSet.getString("chv_emplazamiento"));
                predio.setFotografia(resultSet.getString("chv_fotografia"));
                predio.setTopografiaRefTopog(resultSet.getString("chv_topografia_ref_top"));
                predio.setFotoAerea(resultSet.getString("chv_foto_aerea"));
                predio.setOtraRefTopog(resultSet.getString("chv_otra_ref_top"));
                predio.setCoordenadaE(resultSet.getDouble("db_coord_e"));
                predio.setCoordenadaN(resultSet.getDouble("db_coord_n"));
                predio.setColindantNorte(resultSet.getString("chv_colindant_nort"));
                predio.setColindantEste(resultSet.getString("chv_colindant_este"));
                predio.setColindantSur(resultSet.getString("chv_colindant_sur"));
                predio.setColindantOeste(resultSet.getString("chv_colindant_oest"));
                predio.setFuenteInformante(resultSet.getString("chv_fuente_informant"));
                predio.setTelfInformante(resultSet.getString("chv_telf_informant"));
                predio.setFichaAdjunta(resultSet.getString("chv_ficha_adjunta"));
                predio.setFechaRegistro(resultSet.getTimestamp("ts_fecha_registro"));
                predio.setFechaActualizacion(resultSet.getTimestamp("ts_fecha_actualizacion"));
                predio.setFechaBaja(resultSet.getTimestamp("ts_fecha_baja"));
                predio.setEstadoLogico(resultSet.getString("ch_estado_logico"));
                predio.setPorcentajeExcencion(resultSet.getDouble("db_porcent_excep"));
                predio.setExcencionEspecial(resultSet.getString("chv_excencion_esp"));
                predio.setSectorHomogeneo(FSectorHomogeneo.obtenerSectorHomogeneoDadoCodigo(resultSet.getInt("id_sector_homogeneo")));
                predio.setSessionUsuario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("id_session_usuario")));
                predio.setPlanimetria(resultSet.getString("planimetria"));
                lst.add(predio);
            }
        } catch (Exception e) {
            throw e;
        }
        return lst;
    }

    public static String insertarPredio(PredioV2 predio) throws Exception {
        String band;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "select * from catastro.f_insertar_predio_v2(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setInt(1, predio.getNumFicha());
            prstm.setInt(2, predio.getIdParroquia().getIdParroquia());
            prstm.setInt(3, predio.getZona());
            prstm.setInt(4, predio.getSector());
            prstm.setInt(5, predio.getManzana());
            prstm.setInt(6, predio.getNumPredio());
            prstm.setInt(7, predio.getPropHorBloque());
            prstm.setInt(8, predio.getPropHorPiso());
            prstm.setInt(9, predio.getPropHorUnidad());
            prstm.setString(10, predio.getClaveCatastral());
            prstm.setString(11, predio.getClaveCatastralAnt());
            prstm.setString(12, predio.getBarrio());
            prstm.setString(13, predio.getCallePrinc());
            prstm.setString(14, predio.getCalleSecund());
            prstm.setString(15, predio.getNumCasa());
            prstm.setString(16, predio.getNombreEdificio());
            prstm.setInt(17, predio.getPropietario().getIdPersona());
            prstm.setInt(18, predio.getRepLegal().getIdPersona());
            prstm.setInt(19, predio.getDominio().getIdDominio());
            prstm.setString(20, predio.getCondicion());
            prstm.setString(21, predio.getFormaAdq());
            prstm.setString(22, predio.getNotaria());
            prstm.setDate(23, new java.sql.Date(predio.getFechaTituloProp().getTime()));
            prstm.setDate(24, new java.sql.Date(predio.getFechaRegistroPredio().getTime()));
            prstm.setDouble(25, predio.getAreaEscritura());
            prstm.setString(26, predio.getPropAnterior());
            prstm.setDouble(27, predio.getAvaluoProp());
            prstm.setString(28, predio.getUsoSueloGestion());
            prstm.setString(29, predio.getUsoSueloConsumo());
            prstm.setString(30, predio.getUsoSuelIntercambio());
            prstm.setString(31, predio.getUsoSuelProduc());
            prstm.setString(32, predio.getOcupacionPredio());
            prstm.setString(33, predio.getLocalizacionPredio());
            prstm.setString(34, predio.getTopografiaPredio());
            prstm.setString(35, predio.getFormaPredio());
            prstm.setString(36, predio.getCaracteristSuelo());
            prstm.setString(37, predio.getUsoVias());
            prstm.setString(38, predio.getMaterialVias());
            prstm.setString(39, predio.getRedAgua());
            prstm.setString(40, predio.getAlcantarillado());
            prstm.setString(41, predio.getEnergElectric());
            prstm.setString(42, predio.getRedTelefon());
            prstm.setString(43, predio.getRecBasura());
            prstm.setString(44, predio.getTranspPublico());
            prstm.setString(45, predio.getInternet());
            prstm.setString(46, predio.getOtrosServicios());
            prstm.setDouble(47, predio.getAreaConstruc());
            prstm.setDouble(48, predio.getAreaTotalConst());
            prstm.setDouble(49, predio.getAreaTotalTerreno());
            prstm.setString(50, predio.getPatio());
            prstm.setString(51, predio.getPiscina());
            prstm.setString(52, predio.getCerramiento());
            prstm.setString(53, predio.getCisterna());
            prstm.setString(54, predio.getMuros());
            prstm.setString(55, predio.getAscensor());
            prstm.setInt(56, predio.getNumBanios());
            prstm.setDouble(57, predio.getLinderoFrente1());
            prstm.setDouble(58, predio.getLinderoFrente2());
            prstm.setDouble(59, predio.getLinderoFrente3());
            prstm.setDouble(60, predio.getLinderoFrente4());
            prstm.setString(61, predio.getLinderoCalle1());
            prstm.setString(62, predio.getLinderoCalle2());
            prstm.setString(63, predio.getLinderoCalle3());
            prstm.setString(64, predio.getLinderoCalle4());
            prstm.setDouble(65, predio.getLinderoAlicuota1());
            prstm.setDouble(66, predio.getLinderoAlicuota2());
            prstm.setDouble(67, predio.getLinderoAlicuota3());
            prstm.setDouble(68, predio.getLinderoAlicuota4());
            prstm.setDouble(69, predio.getDerechosAcciones());
            prstm.setString(70, predio.getCroquis());
            prstm.setString(71, predio.getEmplazamiento());
            prstm.setString(72, predio.getFotografia());
            prstm.setString(73, predio.getTopografiaRefTopog());
            prstm.setString(74, predio.getFotoAerea());
            prstm.setString(75, predio.getOtraRefTopog());
            prstm.setDouble(76, predio.getCoordenadaE());
            prstm.setDouble(77, predio.getCoordenadaN());
            prstm.setString(78, predio.getColindantNorte());
            prstm.setString(79, predio.getColindantEste());
            prstm.setString(80, predio.getColindantSur());
            prstm.setString(81, predio.getColindantOeste());
            prstm.setString(82, predio.getFuenteInformante());
            prstm.setString(83, predio.getTelfInformante());
            prstm.setString(84, predio.getFichaAdjunta());
            prstm.setDouble(85, predio.getPorcentajeExcencion());
            prstm.setString(86, predio.getExcencionEspecial());
            prstm.setString(87, predio.getObservaciones());
            prstm.setInt(88, predio.getSectorHomogeneo().getIdSector());
            prstm.setInt(89, predio.getSessionUsuario().getIdPersona());
            prstm.setBoolean(90, predio.getLegalizado());
            resultSet = accesoDatos.ejecutaPrepared(prstm);

            if (resultSet.next()) {
                band = resultSet.getString(1);
                return band;
            } else {
                return null;
            }
        } catch (Exception e) {
            throw e;
        }
    }

    public static PredioV2 obtenerPredioDadoCodigo(int codigo) throws Exception {
        PredioV2 predio = null;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "SELECT * FROM catastro.f_obtener_predio_dado_codigo_v2(?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setInt(1, codigo);
            resultSet = accesoDatos.ejecutaPrepared(prstm);
            while (resultSet.next()) {
                predio = new PredioV2();
                predio.setIdParroquia(new Parroquia());
                predio.setPropietario(new Usuario());
                predio.setRepLegal(new Usuario());
                predio.setDominio(new Dominio());
                predio.setIdPredio(resultSet.getInt("int_id_predio"));
                predio.setNumFicha(resultSet.getInt("int_num_ficha"));
                predio.setIdParroquia(ServiciosParroquia.obtenerParroquiaDadoCodigo(resultSet.getInt("int_id_parroquia")));
                predio.setZona(resultSet.getInt("int_zona"));
                predio.setSector(resultSet.getInt("int_sector"));
                predio.setManzana(resultSet.getInt("int_manzana"));
                predio.setNumPredio(resultSet.getInt("int_num_predio"));
                predio.setPropHorBloque(resultSet.getInt("int_prop_hor_bloque"));
                predio.setPropHorPiso(resultSet.getInt("int_prop_hor_piso"));
                predio.setPropHorUnidad(resultSet.getInt("int_prop_hor_unidad"));
                predio.setClaveCatastral(resultSet.getString("chv_clave_catastral"));
                predio.setClaveCatastralAnt(resultSet.getString("chv_clave_catastral_ant"));
                predio.setBarrio(resultSet.getString("chv_barrio"));
                predio.setCallePrinc(resultSet.getString("chv_calle_princ"));
                predio.setCalleSecund(resultSet.getString("chv_calle_secund"));
                predio.setNumCasa(resultSet.getString("chv_num_casa"));
                predio.setNombreEdificio(resultSet.getString("chv_nombre_edificio"));
                predio.setPropietario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_titular_dom")));
                predio.setRepLegal(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_rep_legal")));
                predio.setDominio(ServiciosDominio.obtenerDominioDadoCodigo(resultSet.getInt("int_id_dominio")));
                predio.setCondicion(resultSet.getString("chv_condicion"));
                predio.setFormaAdq(resultSet.getString("chv_forma_adq"));
                predio.setNotaria(resultSet.getString("chv_notaria"));
                predio.setFechaTituloProp(resultSet.getDate("dt_fecha_titulo_prop"));
                predio.setFechaRegistroPredio(resultSet.getDate("dt_fecha_registro"));
                predio.setAreaEscritura(resultSet.getDouble("db_area_escritura"));
                predio.setPropAnterior(resultSet.getString("chv_prop_anterior"));
                predio.setAvaluoProp(resultSet.getDouble("db_avaluo_prop"));
                predio.setUsoSueloGestion(resultSet.getString("chv_gest_uso_suelo"));
                predio.setUsoSueloConsumo(resultSet.getString("chv_uso_suelo_consumo"));
                predio.setUsoSuelIntercambio(resultSet.getString("chv_us_suel_intercambio"));
                predio.setUsoSuelProduc(resultSet.getString("chv_us_suel_produc"));
                predio.setOcupacionPredio(resultSet.getString("chv_ocupacion_predio"));
                predio.setLocalizacionPredio(resultSet.getString("chv_localizacion_predio"));
                predio.setTopografiaPredio(resultSet.getString("chv_topografia_pedio"));
                predio.setFormaPredio(resultSet.getString("chv_forma_predio"));
                predio.setCaracteristSuelo(resultSet.getString("chv_caract_suelo"));
                predio.setUsoVias(resultSet.getString("chv_uso_vias"));
                predio.setMaterialVias(resultSet.getString("chv_material_vias"));
                predio.setRedAgua(resultSet.getString("chv_red_agua"));
                predio.setAlcantarillado(resultSet.getString("chv_alcantarillado"));
                predio.setEnergElectric(resultSet.getString("chv_energ_electric"));
                predio.setRedTelefon(resultSet.getString("chv_red_telefon"));
                predio.setRecBasura(resultSet.getString("chv_rec_basura"));
                predio.setTranspPublico(resultSet.getString("chv_transp_publico"));
                predio.setInternet(resultSet.getString("chv_internet"));
                predio.setOtrosServicios(resultSet.getString("chv_otros_servicios"));
                predio.setAreaConstruc(resultSet.getDouble("db_area_construc"));
                predio.setAreaTotalConst(resultSet.getDouble("db_area_total_const"));
                predio.setAreaTotalTerreno(resultSet.getDouble("db_area_total_terreno"));
                predio.setPatio(resultSet.getString("chv_patio"));
                predio.setPiscina(resultSet.getString("chv_piscina"));
                predio.setCerramiento(resultSet.getString("chv_cerramiento"));
                predio.setCisterna(resultSet.getString("chv_cisterna"));
                predio.setMuros(resultSet.getString("chv_muros"));
                predio.setAscensor(resultSet.getString("chv_ascensor"));
                predio.setNumBanios(resultSet.getInt("int_num_banios"));
                predio.setLinderoFrente1(resultSet.getDouble("db_lindero_frente1"));
                predio.setLinderoFrente2(resultSet.getDouble("db_lindero_frente2"));
                predio.setLinderoFrente3(resultSet.getDouble("db_lindero_frente3"));
                predio.setLinderoFrente4(resultSet.getDouble("db_lindero_frente4"));
                predio.setLinderoCalle1(resultSet.getString("chv_lindero_calle1"));
                predio.setLinderoCalle2(resultSet.getString("chv_lindero_calle2"));
                predio.setLinderoCalle3(resultSet.getString("chv_lindero_calle3"));
                predio.setLinderoCalle4(resultSet.getString("chv_lindero_calle4"));
                predio.setLinderoAlicuota1(resultSet.getDouble("db_lindero_alicuota1"));
                predio.setLinderoAlicuota2(resultSet.getDouble("db_lindero_alicuota2"));
                predio.setLinderoAlicuota3(resultSet.getDouble("db_lindero_alicuota3"));
                predio.setLinderoAlicuota4(resultSet.getDouble("db_lindero_alicuota4"));
                predio.setCroquis(resultSet.getString("chv_croquis"));
                predio.setEmplazamiento(resultSet.getString("chv_emplazamiento"));
                predio.setFotografia(resultSet.getString("chv_fotografia"));
                predio.setTopografiaRefTopog(resultSet.getString("chv_topografia_ref_top"));
                predio.setFotoAerea(resultSet.getString("chv_foto_aerea"));
                predio.setOtraRefTopog(resultSet.getString("chv_otra_ref_top"));
                predio.setCoordenadaE(resultSet.getDouble("db_coord_e"));
                predio.setCoordenadaN(resultSet.getDouble("db_coord_n"));
                predio.setColindantNorte(resultSet.getString("chv_colindant_nort"));
                predio.setColindantEste(resultSet.getString("chv_colindant_este"));
                predio.setColindantSur(resultSet.getString("chv_colindant_sur"));
                predio.setColindantOeste(resultSet.getString("chv_colindant_oest"));
                predio.setFuenteInformante(resultSet.getString("chv_fuente_informant"));
                predio.setTelfInformante(resultSet.getString("chv_telf_informant"));
                predio.setFichaAdjunta(resultSet.getString("chv_ficha_adjunta"));
                predio.setFechaRegistro(resultSet.getTimestamp("ts_fecha_registro"));
                predio.setFechaActualizacion(resultSet.getTimestamp("ts_fecha_actualizacion"));
                predio.setFechaBaja(resultSet.getTimestamp("ts_fecha_baja"));
                predio.setEstadoLogico(resultSet.getString("ch_estado_logico"));
                predio.setPorcentajeExcencion(resultSet.getDouble("db_porcent_excep"));
                predio.setExcencionEspecial(resultSet.getString("chv_excencion_esp"));
                predio.setSectorHomogeneo(FSectorHomogeneo.obtenerSectorHomogeneoDadoCodigo(resultSet.getInt("id_sector_homogeneo")));
                predio.setSessionUsuario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("id_session_usuario")));
                predio.setPlanimetria(resultSet.getString("planimetria"));
                predio.setSustentoUpdate(resultSet.getString("txt_sustento_update"));
                predio.setSustentoDelete(resultSet.getString("txt_sustento_delete"));
                predio.setObservaciones(resultSet.getString("chv_observaciones"));
            }
            accesoDatos.desconectar();
        } catch (Exception e) {
            throw e;
        }
        return predio;
    }

    public static ArrayList<PredioV2> encontrarPredio(String parametro) throws Exception {
        ArrayList<PredioV2> lst = new ArrayList<>();
        PredioV2 predio;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "SELECT * FROM catastro.f_find_predios_v2(?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setString(1, parametro);
            resultSet = accesoDatos.ejecutaPrepared(prstm);
            while (resultSet.next()) {
                predio = new PredioV2();
                predio.setIdParroquia(new Parroquia());
                predio.setPropietario(new Usuario());
                predio.setRepLegal(new Usuario());
                predio.setDominio(new Dominio());
                predio.setIdPredio(resultSet.getInt("int_id_predio"));
                predio.setNumFicha(resultSet.getInt("int_num_ficha"));
                predio.setIdParroquia(ServiciosParroquia.obtenerParroquiaDadoCodigo(resultSet.getInt("int_id_parroquia")));
                predio.setZona(resultSet.getInt("int_zona"));
                predio.setSector(resultSet.getInt("int_sector"));
                predio.setManzana(resultSet.getInt("int_manzana"));
                predio.setNumPredio(resultSet.getInt("int_num_predio"));
                predio.setPropHorBloque(resultSet.getInt("int_prop_hor_bloque"));
                predio.setPropHorPiso(resultSet.getInt("int_prop_hor_piso"));
                predio.setPropHorUnidad(resultSet.getInt("int_prop_hor_unidad"));
                predio.setClaveCatastral(resultSet.getString("chv_clave_catastral"));
                predio.setClaveCatastralAnt(resultSet.getString("chv_clave_catastral_ant"));
                predio.setBarrio(resultSet.getString("chv_barrio"));
                predio.setCallePrinc(resultSet.getString("chv_calle_princ"));
                predio.setCalleSecund(resultSet.getString("chv_calle_secund"));
                predio.setNumCasa(resultSet.getString("chv_num_casa"));
                predio.setNombreEdificio(resultSet.getString("chv_nombre_edificio"));
                predio.setPropietario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_titular_dom")));
                predio.setRepLegal(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_rep_legal")));
                predio.setDominio(ServiciosDominio.obtenerDominioDadoCodigo(resultSet.getInt("int_id_dominio")));
                predio.setCondicion(resultSet.getString("chv_condicion"));
                predio.setFormaAdq(resultSet.getString("chv_forma_adq"));
                predio.setNotaria(resultSet.getString("chv_notaria"));
                predio.setFechaTituloProp(resultSet.getDate("dt_fecha_titulo_prop"));
                predio.setFechaRegistroPredio(resultSet.getDate("dt_fecha_registro"));
                predio.setAreaEscritura(resultSet.getDouble("db_area_escritura"));
                predio.setPropAnterior(resultSet.getString("chv_prop_anterior"));
                predio.setAvaluoProp(resultSet.getDouble("db_avaluo_prop"));
                predio.setUsoSueloGestion(resultSet.getString("chv_gest_uso_suelo"));
                predio.setUsoSueloConsumo(resultSet.getString("chv_uso_suelo_consumo"));
                predio.setUsoSuelIntercambio(resultSet.getString("chv_us_suel_intercambio"));
                predio.setUsoSuelProduc(resultSet.getString("chv_us_suel_produc"));
                predio.setOcupacionPredio(resultSet.getString("chv_ocupacion_predio"));
                predio.setLocalizacionPredio(resultSet.getString("chv_localizacion_predio"));
                predio.setTopografiaPredio(resultSet.getString("chv_topografia_pedio"));
                predio.setFormaPredio(resultSet.getString("chv_forma_predio"));
                predio.setCaracteristSuelo(resultSet.getString("chv_caract_suelo"));
                predio.setUsoVias(resultSet.getString("chv_uso_vias"));
                predio.setMaterialVias(resultSet.getString("chv_material_vias"));
                predio.setRedAgua(resultSet.getString("chv_red_agua"));
                predio.setAlcantarillado(resultSet.getString("chv_alcantarillado"));
                predio.setEnergElectric(resultSet.getString("chv_energ_electric"));
                predio.setRedTelefon(resultSet.getString("chv_red_telefon"));
                predio.setRecBasura(resultSet.getString("chv_rec_basura"));
                predio.setTranspPublico(resultSet.getString("chv_transp_publico"));
                predio.setInternet(resultSet.getString("chv_internet"));
                predio.setOtrosServicios(resultSet.getString("chv_otros_servicios"));
                predio.setAreaConstruc(resultSet.getDouble("db_area_construc"));
                predio.setAreaTotalConst(resultSet.getDouble("db_area_total_const"));
                predio.setAreaTotalTerreno(resultSet.getDouble("db_area_total_terreno"));
                predio.setPatio(resultSet.getString("chv_patio"));
                predio.setPiscina(resultSet.getString("chv_piscina"));
                predio.setCerramiento(resultSet.getString("chv_cerramiento"));
                predio.setCisterna(resultSet.getString("chv_cisterna"));
                predio.setMuros(resultSet.getString("chv_muros"));
                predio.setAscensor(resultSet.getString("chv_ascensor"));
                predio.setNumBanios(resultSet.getInt("int_num_banios"));
                predio.setLinderoFrente1(resultSet.getDouble("db_lindero_frente1"));
                predio.setLinderoFrente2(resultSet.getDouble("db_lindero_frente2"));
                predio.setLinderoFrente3(resultSet.getDouble("db_lindero_frente3"));
                predio.setLinderoFrente4(resultSet.getDouble("db_lindero_frente4"));
                predio.setLinderoCalle1(resultSet.getString("chv_lindero_calle1"));
                predio.setLinderoCalle2(resultSet.getString("chv_lindero_calle2"));
                predio.setLinderoCalle3(resultSet.getString("chv_lindero_calle3"));
                predio.setLinderoCalle4(resultSet.getString("chv_lindero_calle4"));
                predio.setLinderoAlicuota1(resultSet.getDouble("db_lindero_alicuota1"));
                predio.setLinderoAlicuota2(resultSet.getDouble("db_lindero_alicuota2"));
                predio.setLinderoAlicuota3(resultSet.getDouble("db_lindero_alicuota3"));
                predio.setLinderoAlicuota4(resultSet.getDouble("db_lindero_alicuota4"));
                predio.setCroquis(resultSet.getString("chv_croquis"));
                predio.setEmplazamiento(resultSet.getString("chv_emplazamiento"));
                predio.setFotografia(resultSet.getString("chv_fotografia"));
                predio.setTopografiaRefTopog(resultSet.getString("chv_topografia_ref_top"));
                predio.setFotoAerea(resultSet.getString("chv_foto_aerea"));
                predio.setOtraRefTopog(resultSet.getString("chv_otra_ref_top"));
                predio.setCoordenadaE(resultSet.getDouble("db_coord_e"));
                predio.setCoordenadaN(resultSet.getDouble("db_coord_n"));
                predio.setColindantNorte(resultSet.getString("chv_colindant_nort"));
                predio.setColindantEste(resultSet.getString("chv_colindant_este"));
                predio.setColindantSur(resultSet.getString("chv_colindant_sur"));
                predio.setColindantOeste(resultSet.getString("chv_colindant_oest"));
                predio.setFuenteInformante(resultSet.getString("chv_fuente_informant"));
                predio.setTelfInformante(resultSet.getString("chv_telf_informant"));
                predio.setFichaAdjunta(resultSet.getString("chv_ficha_adjunta"));
                predio.setFechaRegistro(resultSet.getTimestamp("ts_fecha_registro"));
                predio.setFechaActualizacion(resultSet.getTimestamp("ts_fecha_actualizacion"));
                predio.setFechaBaja(resultSet.getTimestamp("ts_fecha_baja"));
                predio.setEstadoLogico(resultSet.getString("ch_estado_logico"));
                predio.setPorcentajeExcencion(resultSet.getDouble("db_porcent_excep"));
                predio.setExcencionEspecial(resultSet.getString("chv_excencion_esp"));
                predio.setSectorHomogeneo(FSectorHomogeneo.obtenerSectorHomogeneoDadoCodigo(resultSet.getInt("id_sector_homogeneo")));
                predio.setSessionUsuario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("id_session_usuario")));
                predio.setPlanimetria(resultSet.getString("planimetria"));
                predio.setSustentoUpdate(resultSet.getString("txt_sustento_update"));
                predio.setSustentoDelete(resultSet.getString("txt_sustento_delete"));
                predio.setObservaciones(resultSet.getString("chv_observaciones"));
                predio.setLegalizado(resultSet.getBoolean("bl_legalizado"));
                lst.add(predio);
            }
        } catch (Exception e) {
            throw e;
        }
        return lst;
    }

    public static PredioV2 obtenerPredioDadoClaveCatastral(String clave) throws Exception {
        PredioV2 predio = null;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "SELECT * FROM catastro.f_obtener_predio_dado_clave_cat_v2(?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setString(1, clave);
            resultSet = accesoDatos.ejecutaPrepared(prstm);
            while (resultSet.next()) {
                predio = new PredioV2();
                predio.setIdParroquia(new Parroquia());
                predio.setPropietario(new Usuario());
                predio.setRepLegal(new Usuario());
                predio.setDominio(new Dominio());
                predio.setIdPredio(resultSet.getInt("int_id_predio"));
                predio.setNumFicha(resultSet.getInt("int_num_ficha"));
                predio.setIdParroquia(ServiciosParroquia.obtenerParroquiaDadoCodigo(resultSet.getInt("int_id_parroquia")));
                predio.setZona(resultSet.getInt("int_zona"));
                predio.setSector(resultSet.getInt("int_sector"));
                predio.setManzana(resultSet.getInt("int_manzana"));
                predio.setNumPredio(resultSet.getInt("int_num_predio"));
                predio.setPropHorBloque(resultSet.getInt("int_prop_hor_bloque"));
                predio.setPropHorPiso(resultSet.getInt("int_prop_hor_piso"));
                predio.setPropHorUnidad(resultSet.getInt("int_prop_hor_unidad"));
                predio.setClaveCatastral(resultSet.getString("chv_clave_catastral"));
                predio.setClaveCatastralAnt(resultSet.getString("chv_clave_catastral_ant"));
                predio.setBarrio(resultSet.getString("chv_barrio"));
                predio.setCallePrinc(resultSet.getString("chv_calle_princ"));
                predio.setCalleSecund(resultSet.getString("chv_calle_secund"));
                predio.setNumCasa(resultSet.getString("chv_num_casa"));
                predio.setNombreEdificio(resultSet.getString("chv_nombre_edificio"));
                predio.setPropietario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_titular_dom")));
                predio.setRepLegal(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_rep_legal")));
                predio.setDominio(ServiciosDominio.obtenerDominioDadoCodigo(resultSet.getInt("int_id_dominio")));
                predio.setCondicion(resultSet.getString("chv_condicion"));
                predio.setFormaAdq(resultSet.getString("chv_forma_adq"));
                predio.setNotaria(resultSet.getString("chv_notaria"));
                predio.setFechaTituloProp(resultSet.getDate("dt_fecha_titulo_prop"));
                predio.setFechaRegistroPredio(resultSet.getDate("dt_fecha_registro"));
                predio.setAreaEscritura(resultSet.getDouble("db_area_escritura"));
                predio.setPropAnterior(resultSet.getString("chv_prop_anterior"));
                predio.setAvaluoProp(resultSet.getDouble("db_avaluo_prop"));
                predio.setUsoSueloGestion(resultSet.getString("chv_gest_uso_suelo"));
                predio.setUsoSueloConsumo(resultSet.getString("chv_uso_suelo_consumo"));
                predio.setUsoSuelIntercambio(resultSet.getString("chv_us_suel_intercambio"));
                predio.setUsoSuelProduc(resultSet.getString("chv_us_suel_produc"));
                predio.setOcupacionPredio(resultSet.getString("chv_ocupacion_predio"));
                predio.setLocalizacionPredio(resultSet.getString("chv_localizacion_predio"));
                predio.setTopografiaPredio(resultSet.getString("chv_topografia_pedio"));
                predio.setFormaPredio(resultSet.getString("chv_forma_predio"));
                predio.setCaracteristSuelo(resultSet.getString("chv_caract_suelo"));
                predio.setUsoVias(resultSet.getString("chv_uso_vias"));
                predio.setMaterialVias(resultSet.getString("chv_material_vias"));
                predio.setRedAgua(resultSet.getString("chv_red_agua"));
                predio.setAlcantarillado(resultSet.getString("chv_alcantarillado"));
                predio.setEnergElectric(resultSet.getString("chv_energ_electric"));
                predio.setRedTelefon(resultSet.getString("chv_red_telefon"));
                predio.setRecBasura(resultSet.getString("chv_rec_basura"));
                predio.setTranspPublico(resultSet.getString("chv_transp_publico"));
                predio.setInternet(resultSet.getString("chv_internet"));
                predio.setOtrosServicios(resultSet.getString("chv_otros_servicios"));
                predio.setAreaConstruc(resultSet.getDouble("db_area_construc"));
                predio.setAreaTotalConst(resultSet.getDouble("db_area_total_const"));
                predio.setAreaTotalTerreno(resultSet.getDouble("db_area_total_terreno"));
                predio.setPatio(resultSet.getString("chv_patio"));
                predio.setPiscina(resultSet.getString("chv_piscina"));
                predio.setCerramiento(resultSet.getString("chv_cerramiento"));
                predio.setCisterna(resultSet.getString("chv_cisterna"));
                predio.setMuros(resultSet.getString("chv_muros"));
                predio.setAscensor(resultSet.getString("chv_ascensor"));
                predio.setNumBanios(resultSet.getInt("int_num_banios"));
                predio.setLinderoFrente1(resultSet.getDouble("db_lindero_frente1"));
                predio.setLinderoFrente2(resultSet.getDouble("db_lindero_frente2"));
                predio.setLinderoFrente3(resultSet.getDouble("db_lindero_frente3"));
                predio.setLinderoFrente4(resultSet.getDouble("db_lindero_frente4"));
                predio.setLinderoCalle1(resultSet.getString("chv_lindero_calle1"));
                predio.setLinderoCalle2(resultSet.getString("chv_lindero_calle2"));
                predio.setLinderoCalle3(resultSet.getString("chv_lindero_calle3"));
                predio.setLinderoCalle4(resultSet.getString("chv_lindero_calle4"));
                predio.setLinderoAlicuota1(resultSet.getDouble("db_lindero_alicuota1"));
                predio.setLinderoAlicuota2(resultSet.getDouble("db_lindero_alicuota2"));
                predio.setLinderoAlicuota3(resultSet.getDouble("db_lindero_alicuota3"));
                predio.setLinderoAlicuota4(resultSet.getDouble("db_lindero_alicuota4"));
                predio.setCroquis(resultSet.getString("chv_croquis"));
                predio.setEmplazamiento(resultSet.getString("chv_emplazamiento"));
                predio.setFotografia(resultSet.getString("chv_fotografia"));
                predio.setTopografiaRefTopog(resultSet.getString("chv_topografia_ref_top"));
                predio.setFotoAerea(resultSet.getString("chv_foto_aerea"));
                predio.setOtraRefTopog(resultSet.getString("chv_otra_ref_top"));
                predio.setCoordenadaE(resultSet.getDouble("db_coord_e"));
                predio.setCoordenadaN(resultSet.getDouble("db_coord_n"));
                predio.setColindantNorte(resultSet.getString("chv_colindant_nort"));
                predio.setColindantEste(resultSet.getString("chv_colindant_este"));
                predio.setColindantSur(resultSet.getString("chv_colindant_sur"));
                predio.setColindantOeste(resultSet.getString("chv_colindant_oest"));
                predio.setFuenteInformante(resultSet.getString("chv_fuente_informant"));
                predio.setTelfInformante(resultSet.getString("chv_telf_informant"));
                predio.setFichaAdjunta(resultSet.getString("chv_ficha_adjunta"));
                predio.setFechaRegistro(resultSet.getTimestamp("ts_fecha_registro"));
                predio.setFechaActualizacion(resultSet.getTimestamp("ts_fecha_actualizacion"));
                predio.setFechaBaja(resultSet.getTimestamp("ts_fecha_baja"));
                predio.setEstadoLogico(resultSet.getString("ch_estado_logico"));
                predio.setPorcentajeExcencion(resultSet.getDouble("db_porcent_excep"));
                predio.setExcencionEspecial(resultSet.getString("chv_excencion_esp"));
                predio.setSectorHomogeneo(FSectorHomogeneo.obtenerSectorHomogeneoDadoCodigo(resultSet.getInt("id_sector_homogeneo")));
                predio.setSessionUsuario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("id_session_usuario")));
                predio.setPlanimetria(resultSet.getString("planimetria"));
            }
            accesoDatos.desconectar();
        } catch (Exception e) {
            throw e;
        }
        return predio;
    }

    public static String insertarFotografiaPredio(PredioV2 predio) throws Exception {
        String band;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "select * from catastro.f_actualizar_foto_predio(?,?,?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setInt(1, predio.getIdPredio());
            prstm.setString(2, predio.getFotografia());
            prstm.setInt(3, predio.getSessionUsuario().getIdPersona());
            resultSet = accesoDatos.ejecutaPrepared(prstm);

            if (resultSet.next()) {
                band = resultSet.getString(1);
                return band;
            } else {
                return null;
            }
        } catch (Exception e) {
            throw e;
        }
    }

    public static String insertarPlanimetriaPredio(PredioV2 predio) throws Exception {
        String band;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "select * from catastro.f_actualizar_planimetria(?,?,?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setInt(1, predio.getIdPredio());
            prstm.setString(2, predio.getPlanimetria());
            prstm.setInt(3, predio.getSessionUsuario().getIdPersona());
            resultSet = accesoDatos.ejecutaPrepared(prstm);

            if (resultSet.next()) {
                band = resultSet.getString(1);
                return band;
            } else {
                return null;
            }
        } catch (Exception e) {
            throw e;
        }
    }

    public static ArrayList<PredioV2> obtenerPrediosDadoPropietario(int codigoPropietario) throws Exception {
        ArrayList<PredioV2> lst = new ArrayList<>();
        PredioV2 predio;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "SELECT * FROM catastro.f_seleccionar_predios_dado_cliente(?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setInt(1, codigoPropietario);
            resultSet = accesoDatos.ejecutaPrepared(prstm);
            while (resultSet.next()) {
                predio = new PredioV2();
                predio.setIdParroquia(new Parroquia());
                predio.setPropietario(new Usuario());
                predio.setRepLegal(new Usuario());
                predio.setDominio(new Dominio());
                predio.setIdPredio(resultSet.getInt("int_id_predio"));
                predio.setNumFicha(resultSet.getInt("int_num_ficha"));
                predio.setIdParroquia(ServiciosParroquia.obtenerParroquiaDadoCodigo(resultSet.getInt("int_id_parroquia")));
                predio.setZona(resultSet.getInt("int_zona"));
                predio.setSector(resultSet.getInt("int_sector"));
                predio.setManzana(resultSet.getInt("int_manzana"));
                predio.setNumPredio(resultSet.getInt("int_num_predio"));
                predio.setPropHorBloque(resultSet.getInt("int_prop_hor_bloque"));
                predio.setPropHorPiso(resultSet.getInt("int_prop_hor_piso"));
                predio.setPropHorUnidad(resultSet.getInt("int_prop_hor_unidad"));
                predio.setClaveCatastral(resultSet.getString("chv_clave_catastral"));
                predio.setClaveCatastralAnt(resultSet.getString("chv_clave_catastral_ant"));
                predio.setBarrio(resultSet.getString("chv_barrio"));
                predio.setCallePrinc(resultSet.getString("chv_calle_princ"));
                predio.setCalleSecund(resultSet.getString("chv_calle_secund"));
                predio.setNumCasa(resultSet.getString("chv_num_casa"));
                predio.setNombreEdificio(resultSet.getString("chv_nombre_edificio"));
                predio.setPropietario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_titular_dom")));
                predio.setRepLegal(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_rep_legal")));
                predio.setDominio(ServiciosDominio.obtenerDominioDadoCodigo(resultSet.getInt("int_id_dominio")));
                predio.setCondicion(resultSet.getString("chv_condicion"));
                predio.setFormaAdq(resultSet.getString("chv_forma_adq"));
                predio.setNotaria(resultSet.getString("chv_notaria"));
                predio.setFechaTituloProp(resultSet.getDate("dt_fecha_titulo_prop"));
                predio.setFechaRegistroPredio(resultSet.getDate("dt_fecha_registro"));
                predio.setAreaEscritura(resultSet.getDouble("db_area_escritura"));
                predio.setPropAnterior(resultSet.getString("chv_prop_anterior"));
                predio.setAvaluoProp(resultSet.getDouble("db_avaluo_prop"));
                predio.setUsoSueloGestion(resultSet.getString("chv_gest_uso_suelo"));
                predio.setUsoSueloConsumo(resultSet.getString("chv_uso_suelo_consumo"));
                predio.setUsoSuelIntercambio(resultSet.getString("chv_us_suel_intercambio"));
                predio.setUsoSuelProduc(resultSet.getString("chv_us_suel_produc"));
                predio.setOcupacionPredio(resultSet.getString("chv_ocupacion_predio"));
                predio.setLocalizacionPredio(resultSet.getString("chv_localizacion_predio"));
                predio.setTopografiaPredio(resultSet.getString("chv_topografia_pedio"));
                predio.setFormaPredio(resultSet.getString("chv_forma_predio"));
                predio.setCaracteristSuelo(resultSet.getString("chv_caract_suelo"));
                predio.setUsoVias(resultSet.getString("chv_uso_vias"));
                predio.setMaterialVias(resultSet.getString("chv_material_vias"));
                predio.setRedAgua(resultSet.getString("chv_red_agua"));
                predio.setAlcantarillado(resultSet.getString("chv_alcantarillado"));
                predio.setEnergElectric(resultSet.getString("chv_energ_electric"));
                predio.setRedTelefon(resultSet.getString("chv_red_telefon"));
                predio.setRecBasura(resultSet.getString("chv_rec_basura"));
                predio.setTranspPublico(resultSet.getString("chv_transp_publico"));
                predio.setInternet(resultSet.getString("chv_internet"));
                predio.setOtrosServicios(resultSet.getString("chv_otros_servicios"));
                predio.setAreaConstruc(resultSet.getDouble("db_area_construc"));
                predio.setAreaTotalConst(resultSet.getDouble("db_area_total_const"));
                predio.setAreaTotalTerreno(resultSet.getDouble("db_area_total_terreno"));
                predio.setPatio(resultSet.getString("chv_patio"));
                predio.setPiscina(resultSet.getString("chv_piscina"));
                predio.setCerramiento(resultSet.getString("chv_cerramiento"));
                predio.setCisterna(resultSet.getString("chv_cisterna"));
                predio.setMuros(resultSet.getString("chv_muros"));
                predio.setAscensor(resultSet.getString("chv_ascensor"));
                predio.setNumBanios(resultSet.getInt("int_num_banios"));
                predio.setLinderoFrente1(resultSet.getDouble("db_lindero_frente1"));
                predio.setLinderoFrente2(resultSet.getDouble("db_lindero_frente2"));
                predio.setLinderoFrente3(resultSet.getDouble("db_lindero_frente3"));
                predio.setLinderoFrente4(resultSet.getDouble("db_lindero_frente4"));
                predio.setLinderoCalle1(resultSet.getString("chv_lindero_calle1"));
                predio.setLinderoCalle2(resultSet.getString("chv_lindero_calle2"));
                predio.setLinderoCalle3(resultSet.getString("chv_lindero_calle3"));
                predio.setLinderoCalle4(resultSet.getString("chv_lindero_calle4"));
                predio.setLinderoAlicuota1(resultSet.getDouble("db_lindero_alicuota1"));
                predio.setLinderoAlicuota2(resultSet.getDouble("db_lindero_alicuota2"));
                predio.setLinderoAlicuota3(resultSet.getDouble("db_lindero_alicuota3"));
                predio.setLinderoAlicuota4(resultSet.getDouble("db_lindero_alicuota4"));
                predio.setCroquis(resultSet.getString("chv_croquis"));
                predio.setEmplazamiento(resultSet.getString("chv_emplazamiento"));
                predio.setFotografia(resultSet.getString("chv_fotografia"));
                predio.setTopografiaRefTopog(resultSet.getString("chv_topografia_ref_top"));
                predio.setFotoAerea(resultSet.getString("chv_foto_aerea"));
                predio.setOtraRefTopog(resultSet.getString("chv_otra_ref_top"));
                predio.setCoordenadaE(resultSet.getDouble("db_coord_e"));
                predio.setCoordenadaN(resultSet.getDouble("db_coord_n"));
                predio.setColindantNorte(resultSet.getString("chv_colindant_nort"));
                predio.setColindantEste(resultSet.getString("chv_colindant_este"));
                predio.setColindantSur(resultSet.getString("chv_colindant_sur"));
                predio.setColindantOeste(resultSet.getString("chv_colindant_oest"));
                predio.setFuenteInformante(resultSet.getString("chv_fuente_informant"));
                predio.setTelfInformante(resultSet.getString("chv_telf_informant"));
                predio.setFichaAdjunta(resultSet.getString("chv_ficha_adjunta"));
                predio.setFechaRegistro(resultSet.getTimestamp("ts_fecha_registro"));
                predio.setFechaActualizacion(resultSet.getTimestamp("ts_fecha_actualizacion"));
                predio.setFechaBaja(resultSet.getTimestamp("ts_fecha_baja"));
                predio.setEstadoLogico(resultSet.getString("ch_estado_logico"));
                predio.setPorcentajeExcencion(resultSet.getDouble("db_porcent_excep"));
                predio.setExcencionEspecial(resultSet.getString("chv_excencion_esp"));
                predio.setSectorHomogeneo(FSectorHomogeneo.obtenerSectorHomogeneoDadoCodigo(resultSet.getInt("id_sector_homogeneo")));
                predio.setSessionUsuario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("id_session_usuario")));
                predio.setPlanimetria(resultSet.getString("planimetria"));
                lst.add(predio);
            }
        } catch (Exception e) {
            throw e;
        }
        return lst;
    }

    public static String actualizarPredio(PredioV2 predio) throws Exception {
        String respuesta;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "select * from catastro.f_actualizar_predio_v2(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?);";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setInt(1, predio.getNumFicha());
            prstm.setInt(2, predio.getIdParroquia().getIdParroquia());
            prstm.setInt(3, predio.getZona());
            prstm.setInt(4, predio.getSector());
            prstm.setInt(5, predio.getManzana());
            prstm.setInt(6, predio.getNumPredio());
            prstm.setInt(7, predio.getPropHorBloque());
            prstm.setInt(8, predio.getPropHorPiso());
            prstm.setInt(9, predio.getPropHorUnidad());
            prstm.setString(10, predio.getClaveCatastral());
            prstm.setString(11, predio.getClaveCatastralAnt());
            prstm.setString(12, predio.getBarrio());
            prstm.setString(13, predio.getCallePrinc());
            prstm.setString(14, predio.getCalleSecund());
            prstm.setString(15, predio.getNumCasa());
            prstm.setString(16, predio.getNombreEdificio());
            prstm.setInt(17, predio.getPropietario().getIdPersona());
            prstm.setInt(18, predio.getRepLegal().getIdPersona());
            prstm.setInt(19, predio.getDominio().getIdDominio());
            prstm.setString(20, predio.getCondicion());
            prstm.setString(21, predio.getFormaAdq());
            prstm.setString(22, predio.getNotaria());
            prstm.setDate(23, new java.sql.Date(predio.getFechaTituloProp().getTime()));
            prstm.setDate(24, new java.sql.Date(predio.getFechaRegistroPredio().getTime()));
            prstm.setDouble(25, predio.getAreaEscritura());
            prstm.setString(26, predio.getPropAnterior());
            prstm.setDouble(27, predio.getAvaluoProp());
            prstm.setString(28, predio.getUsoSueloGestion());
            prstm.setString(29, predio.getUsoSueloConsumo());
            prstm.setString(30, predio.getUsoSuelIntercambio());
            prstm.setString(31, predio.getUsoSuelProduc());
            prstm.setString(32, predio.getOcupacionPredio());
            prstm.setString(33, predio.getLocalizacionPredio());
            prstm.setString(34, predio.getTopografiaPredio());
            prstm.setString(35, predio.getFormaPredio());
            prstm.setString(36, predio.getCaracteristSuelo());
            prstm.setString(37, predio.getUsoVias());
            prstm.setString(38, predio.getMaterialVias());
            prstm.setString(39, predio.getRedAgua());
            prstm.setString(40, predio.getAlcantarillado());
            prstm.setString(41, predio.getEnergElectric());
            prstm.setString(42, predio.getRedTelefon());
            prstm.setString(43, predio.getRecBasura());
            prstm.setString(44, predio.getTranspPublico());
            prstm.setString(45, predio.getInternet());
            prstm.setString(46, predio.getOtrosServicios());
            prstm.setDouble(47, predio.getAreaConstruc());
            prstm.setDouble(48, predio.getAreaTotalConst());
            prstm.setDouble(49, predio.getAreaTotalTerreno());
            prstm.setString(50, predio.getPatio());
            prstm.setString(51, predio.getPiscina());
            prstm.setString(52, predio.getCerramiento());
            prstm.setString(53, predio.getCisterna());
            prstm.setString(54, predio.getMuros());
            prstm.setString(55, predio.getAscensor());
            prstm.setInt(56, predio.getNumBanios());
            prstm.setDouble(57, predio.getLinderoFrente1());
            prstm.setDouble(58, predio.getLinderoFrente2());
            prstm.setDouble(59, predio.getLinderoFrente3());
            prstm.setDouble(60, predio.getLinderoFrente4());
            prstm.setString(61, predio.getLinderoCalle1());
            prstm.setString(62, predio.getLinderoCalle2());
            prstm.setString(63, predio.getLinderoCalle3());
            prstm.setString(64, predio.getLinderoCalle4());
            prstm.setDouble(65, predio.getLinderoAlicuota1());
            prstm.setDouble(66, predio.getLinderoAlicuota2());
            prstm.setDouble(67, predio.getLinderoAlicuota3());
            prstm.setDouble(68, predio.getLinderoAlicuota4());
            prstm.setDouble(69, predio.getDerechosAcciones());
            prstm.setString(70, predio.getCroquis());
            prstm.setString(71, predio.getEmplazamiento());
            prstm.setString(72, predio.getFotografia());
            prstm.setString(73, predio.getTopografiaRefTopog());
            prstm.setString(74, predio.getFotoAerea());
            prstm.setString(75, predio.getOtraRefTopog());
            prstm.setDouble(76, predio.getCoordenadaE());
            prstm.setDouble(77, predio.getCoordenadaN());
            prstm.setString(78, predio.getColindantNorte());
            prstm.setString(79, predio.getColindantEste());
            prstm.setString(80, predio.getColindantSur());
            prstm.setString(81, predio.getColindantOeste());
            prstm.setString(82, predio.getFuenteInformante());
            prstm.setString(83, predio.getTelfInformante());
            prstm.setString(84, predio.getFichaAdjunta());
            prstm.setDouble(85, predio.getPorcentajeExcencion());
            prstm.setString(86, predio.getExcencionEspecial());
            prstm.setString(87, predio.getObservaciones());
            prstm.setString(88, predio.getSustentoUpdate());
            prstm.setBoolean(89, predio.getLegalizado());
            prstm.setInt(90, predio.getSessionUsuario().getIdPersona());
            prstm.setString(91, predio.getSustentoUpdate());
            prstm.setInt(92, predio.getIdPredio());
            resultSet = accesoDatos.ejecutaPrepared(prstm);
            if (resultSet.next()) {
                respuesta = resultSet.getString(1);
                return respuesta;
            } else {
                return null;
            }
        } catch (Exception e) {
            throw e;
        }
    }

    public static ArrayList<PredioV2> seleccionarOcupacionesPredios() throws Exception {
        ArrayList<PredioV2> lst = new ArrayList<>();
        AccesoDatos accesoDatos;
        PredioV2 predio;
        ResultSet resultSet;
        String sql;
        try {
            accesoDatos = new AccesoDatos();
            sql = "SELECT * from catastro.f_select_ocupaciones_predio();";
            resultSet = accesoDatos.ejecutaQuery(sql);
            while (resultSet.next()) {
                predio = new PredioV2();
                predio.setIdParroquia(new Parroquia());
                predio.setPropietario(new Usuario());
                predio.setRepLegal(new Usuario());
                predio.setDominio(new Dominio());
                predio.setIdPredio(resultSet.getInt("int_id_predio"));
                predio.setNumFicha(resultSet.getInt("int_num_ficha"));
                predio.setIdParroquia(ServiciosParroquia.obtenerParroquiaDadoCodigo(resultSet.getInt("int_id_parroquia")));
                predio.setZona(resultSet.getInt("int_zona"));
                predio.setSector(resultSet.getInt("int_sector"));
                predio.setManzana(resultSet.getInt("int_manzana"));
                predio.setNumPredio(resultSet.getInt("int_num_predio"));
                predio.setPropHorBloque(resultSet.getInt("int_prop_hor_bloque"));
                predio.setPropHorPiso(resultSet.getInt("int_prop_hor_piso"));
                predio.setPropHorUnidad(resultSet.getInt("int_prop_hor_unidad"));
                predio.setClaveCatastral(resultSet.getString("chv_clave_catastral"));
                predio.setClaveCatastralAnt(resultSet.getString("chv_clave_catastral_ant"));
                predio.setBarrio(resultSet.getString("chv_barrio"));
                predio.setCallePrinc(resultSet.getString("chv_calle_princ"));
                predio.setCalleSecund(resultSet.getString("chv_calle_secund"));
                predio.setNumCasa(resultSet.getString("chv_num_casa"));
                predio.setNombreEdificio(resultSet.getString("chv_nombre_edificio"));
                predio.setPropietario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_titular_dom")));
                predio.setRepLegal(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_rep_legal")));
                predio.setDominio(ServiciosDominio.obtenerDominioDadoCodigo(resultSet.getInt("int_id_dominio")));
                predio.setCondicion(resultSet.getString("chv_condicion"));
                predio.setFormaAdq(resultSet.getString("chv_forma_adq"));
                predio.setNotaria(resultSet.getString("chv_notaria"));
                predio.setFechaTituloProp(resultSet.getDate("dt_fecha_titulo_prop"));
                predio.setFechaRegistroPredio(resultSet.getDate("dt_fecha_registro"));
                predio.setAreaEscritura(resultSet.getDouble("db_area_escritura"));
                predio.setPropAnterior(resultSet.getString("chv_prop_anterior"));
                predio.setAvaluoProp(resultSet.getDouble("db_avaluo_prop"));
                predio.setUsoSueloGestion(resultSet.getString("chv_gest_uso_suelo"));
                predio.setUsoSueloConsumo(resultSet.getString("chv_uso_suelo_consumo"));
                predio.setUsoSuelIntercambio(resultSet.getString("chv_us_suel_intercambio"));
                predio.setUsoSuelProduc(resultSet.getString("chv_us_suel_produc"));
                predio.setOcupacionPredio(resultSet.getString("chv_ocupacion_predio"));
                predio.setLocalizacionPredio(resultSet.getString("chv_localizacion_predio"));
                predio.setTopografiaPredio(resultSet.getString("chv_topografia_pedio"));
                predio.setFormaPredio(resultSet.getString("chv_forma_predio"));
                predio.setCaracteristSuelo(resultSet.getString("chv_caract_suelo"));
                predio.setUsoVias(resultSet.getString("chv_uso_vias"));
                predio.setMaterialVias(resultSet.getString("chv_material_vias"));
                predio.setRedAgua(resultSet.getString("chv_red_agua"));
                predio.setAlcantarillado(resultSet.getString("chv_alcantarillado"));
                predio.setEnergElectric(resultSet.getString("chv_energ_electric"));
                predio.setRedTelefon(resultSet.getString("chv_red_telefon"));
                predio.setRecBasura(resultSet.getString("chv_rec_basura"));
                predio.setTranspPublico(resultSet.getString("chv_transp_publico"));
                predio.setInternet(resultSet.getString("chv_internet"));
                predio.setOtrosServicios(resultSet.getString("chv_otros_servicios"));
                predio.setAreaConstruc(resultSet.getDouble("db_area_construc"));
                predio.setAreaTotalConst(resultSet.getDouble("db_area_total_const"));
                predio.setAreaTotalTerreno(resultSet.getDouble("db_area_total_terreno"));
                predio.setPatio(resultSet.getString("chv_patio"));
                predio.setPiscina(resultSet.getString("chv_piscina"));
                predio.setCerramiento(resultSet.getString("chv_cerramiento"));
                predio.setCisterna(resultSet.getString("chv_cisterna"));
                predio.setMuros(resultSet.getString("chv_muros"));
                predio.setAscensor(resultSet.getString("chv_ascensor"));
                predio.setNumBanios(resultSet.getInt("int_num_banios"));
                predio.setLinderoFrente1(resultSet.getDouble("db_lindero_frente1"));
                predio.setLinderoFrente2(resultSet.getDouble("db_lindero_frente2"));
                predio.setLinderoFrente3(resultSet.getDouble("db_lindero_frente3"));
                predio.setLinderoFrente4(resultSet.getDouble("db_lindero_frente4"));
                predio.setLinderoCalle1(resultSet.getString("chv_lindero_calle1"));
                predio.setLinderoCalle2(resultSet.getString("chv_lindero_calle2"));
                predio.setLinderoCalle3(resultSet.getString("chv_lindero_calle3"));
                predio.setLinderoCalle4(resultSet.getString("chv_lindero_calle4"));
                predio.setLinderoAlicuota1(resultSet.getDouble("db_lindero_alicuota1"));
                predio.setLinderoAlicuota2(resultSet.getDouble("db_lindero_alicuota2"));
                predio.setLinderoAlicuota3(resultSet.getDouble("db_lindero_alicuota3"));
                predio.setLinderoAlicuota4(resultSet.getDouble("db_lindero_alicuota4"));
                predio.setCroquis(resultSet.getString("chv_croquis"));
                predio.setEmplazamiento(resultSet.getString("chv_emplazamiento"));
                predio.setFotografia(resultSet.getString("chv_fotografia"));
                predio.setTopografiaRefTopog(resultSet.getString("chv_topografia_ref_top"));
                predio.setFotoAerea(resultSet.getString("chv_foto_aerea"));
                predio.setOtraRefTopog(resultSet.getString("chv_otra_ref_top"));
                predio.setCoordenadaE(resultSet.getDouble("db_coord_e"));
                predio.setCoordenadaN(resultSet.getDouble("db_coord_n"));
                predio.setColindantNorte(resultSet.getString("chv_colindant_nort"));
                predio.setColindantEste(resultSet.getString("chv_colindant_este"));
                predio.setColindantSur(resultSet.getString("chv_colindant_sur"));
                predio.setColindantOeste(resultSet.getString("chv_colindant_oest"));
                predio.setFuenteInformante(resultSet.getString("chv_fuente_informant"));
                predio.setTelfInformante(resultSet.getString("chv_telf_informant"));
                predio.setFichaAdjunta(resultSet.getString("chv_ficha_adjunta"));
                predio.setFechaRegistro(resultSet.getTimestamp("ts_fecha_registro"));
                predio.setFechaActualizacion(resultSet.getTimestamp("ts_fecha_actualizacion"));
                predio.setFechaBaja(resultSet.getTimestamp("ts_fecha_baja"));
                predio.setEstadoLogico(resultSet.getString("ch_estado_logico"));
                predio.setPorcentajeExcencion(resultSet.getDouble("db_porcent_excep"));
                predio.setExcencionEspecial(resultSet.getString("chv_excencion_esp"));
                predio.setSectorHomogeneo(FSectorHomogeneo.obtenerSectorHomogeneoDadoCodigo(resultSet.getInt("id_sector_homogeneo")));
                predio.setSessionUsuario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("id_session_usuario")));
                predio.setPlanimetria(resultSet.getString("planimetria"));
                lst.add(predio);
            }
        } catch (Exception e) {
            throw e;
        }
        return lst;
    }

    public static ArrayList<PredioV2> seleccionarPrediosDadoOcupacion(String ocupacion) throws Exception {
        ArrayList<PredioV2> lst = new ArrayList<>();
        PredioV2 predio;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "SELECT * FROM catastro.f_select_predios_dado_ocupacion(?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setString(1, ocupacion);
            resultSet = accesoDatos.ejecutaPrepared(prstm);
            while (resultSet.next()) {
                predio = new PredioV2();
                predio.setIdParroquia(new Parroquia());
                predio.setPropietario(new Usuario());
                predio.setRepLegal(new Usuario());
                predio.setDominio(new Dominio());
                predio.setIdPredio(resultSet.getInt("int_id_predio"));
                predio.setNumFicha(resultSet.getInt("int_num_ficha"));
                predio.setIdParroquia(ServiciosParroquia.obtenerParroquiaDadoCodigo(resultSet.getInt("int_id_parroquia")));
                predio.setZona(resultSet.getInt("int_zona"));
                predio.setSector(resultSet.getInt("int_sector"));
                predio.setManzana(resultSet.getInt("int_manzana"));
                predio.setNumPredio(resultSet.getInt("int_num_predio"));
                predio.setPropHorBloque(resultSet.getInt("int_prop_hor_bloque"));
                predio.setPropHorPiso(resultSet.getInt("int_prop_hor_piso"));
                predio.setPropHorUnidad(resultSet.getInt("int_prop_hor_unidad"));
                predio.setClaveCatastral(resultSet.getString("chv_clave_catastral"));
                predio.setClaveCatastralAnt(resultSet.getString("chv_clave_catastral_ant"));
                predio.setBarrio(resultSet.getString("chv_barrio"));
                predio.setCallePrinc(resultSet.getString("chv_calle_princ"));
                predio.setCalleSecund(resultSet.getString("chv_calle_secund"));
                predio.setNumCasa(resultSet.getString("chv_num_casa"));
                predio.setNombreEdificio(resultSet.getString("chv_nombre_edificio"));
                predio.setPropietario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_titular_dom")));
                predio.setRepLegal(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_rep_legal")));
                predio.setDominio(ServiciosDominio.obtenerDominioDadoCodigo(resultSet.getInt("int_id_dominio")));
                predio.setCondicion(resultSet.getString("chv_condicion"));
                predio.setFormaAdq(resultSet.getString("chv_forma_adq"));
                predio.setNotaria(resultSet.getString("chv_notaria"));
                predio.setFechaTituloProp(resultSet.getDate("dt_fecha_titulo_prop"));
                predio.setFechaRegistroPredio(resultSet.getDate("dt_fecha_registro"));
                predio.setAreaEscritura(resultSet.getDouble("db_area_escritura"));
                predio.setPropAnterior(resultSet.getString("chv_prop_anterior"));
                predio.setAvaluoProp(resultSet.getDouble("db_avaluo_prop"));
                predio.setUsoSueloGestion(resultSet.getString("chv_gest_uso_suelo"));
                predio.setUsoSueloConsumo(resultSet.getString("chv_uso_suelo_consumo"));
                predio.setUsoSuelIntercambio(resultSet.getString("chv_us_suel_intercambio"));
                predio.setUsoSuelProduc(resultSet.getString("chv_us_suel_produc"));
                predio.setOcupacionPredio(resultSet.getString("chv_ocupacion_predio"));
                predio.setLocalizacionPredio(resultSet.getString("chv_localizacion_predio"));
                predio.setTopografiaPredio(resultSet.getString("chv_topografia_pedio"));
                predio.setFormaPredio(resultSet.getString("chv_forma_predio"));
                predio.setCaracteristSuelo(resultSet.getString("chv_caract_suelo"));
                predio.setUsoVias(resultSet.getString("chv_uso_vias"));
                predio.setMaterialVias(resultSet.getString("chv_material_vias"));
                predio.setRedAgua(resultSet.getString("chv_red_agua"));
                predio.setAlcantarillado(resultSet.getString("chv_alcantarillado"));
                predio.setEnergElectric(resultSet.getString("chv_energ_electric"));
                predio.setRedTelefon(resultSet.getString("chv_red_telefon"));
                predio.setRecBasura(resultSet.getString("chv_rec_basura"));
                predio.setTranspPublico(resultSet.getString("chv_transp_publico"));
                predio.setInternet(resultSet.getString("chv_internet"));
                predio.setOtrosServicios(resultSet.getString("chv_otros_servicios"));
                predio.setAreaConstruc(resultSet.getDouble("db_area_construc"));
                predio.setAreaTotalConst(resultSet.getDouble("db_area_total_const"));
                predio.setAreaTotalTerreno(resultSet.getDouble("db_area_total_terreno"));
                predio.setPatio(resultSet.getString("chv_patio"));
                predio.setPiscina(resultSet.getString("chv_piscina"));
                predio.setCerramiento(resultSet.getString("chv_cerramiento"));
                predio.setCisterna(resultSet.getString("chv_cisterna"));
                predio.setMuros(resultSet.getString("chv_muros"));
                predio.setAscensor(resultSet.getString("chv_ascensor"));
                predio.setNumBanios(resultSet.getInt("int_num_banios"));
                predio.setLinderoFrente1(resultSet.getDouble("db_lindero_frente1"));
                predio.setLinderoFrente2(resultSet.getDouble("db_lindero_frente2"));
                predio.setLinderoFrente3(resultSet.getDouble("db_lindero_frente3"));
                predio.setLinderoFrente4(resultSet.getDouble("db_lindero_frente4"));
                predio.setLinderoCalle1(resultSet.getString("chv_lindero_calle1"));
                predio.setLinderoCalle2(resultSet.getString("chv_lindero_calle2"));
                predio.setLinderoCalle3(resultSet.getString("chv_lindero_calle3"));
                predio.setLinderoCalle4(resultSet.getString("chv_lindero_calle4"));
                predio.setLinderoAlicuota1(resultSet.getDouble("db_lindero_alicuota1"));
                predio.setLinderoAlicuota2(resultSet.getDouble("db_lindero_alicuota2"));
                predio.setLinderoAlicuota3(resultSet.getDouble("db_lindero_alicuota3"));
                predio.setLinderoAlicuota4(resultSet.getDouble("db_lindero_alicuota4"));
                predio.setCroquis(resultSet.getString("chv_croquis"));
                predio.setEmplazamiento(resultSet.getString("chv_emplazamiento"));
                predio.setFotografia(resultSet.getString("chv_fotografia"));
                predio.setTopografiaRefTopog(resultSet.getString("chv_topografia_ref_top"));
                predio.setFotoAerea(resultSet.getString("chv_foto_aerea"));
                predio.setOtraRefTopog(resultSet.getString("chv_otra_ref_top"));
                predio.setCoordenadaE(resultSet.getDouble("db_coord_e"));
                predio.setCoordenadaN(resultSet.getDouble("db_coord_n"));
                predio.setColindantNorte(resultSet.getString("chv_colindant_nort"));
                predio.setColindantEste(resultSet.getString("chv_colindant_este"));
                predio.setColindantSur(resultSet.getString("chv_colindant_sur"));
                predio.setColindantOeste(resultSet.getString("chv_colindant_oest"));
                predio.setFuenteInformante(resultSet.getString("chv_fuente_informant"));
                predio.setTelfInformante(resultSet.getString("chv_telf_informant"));
                predio.setFichaAdjunta(resultSet.getString("chv_ficha_adjunta"));
                predio.setFechaRegistro(resultSet.getTimestamp("ts_fecha_registro"));
                predio.setFechaActualizacion(resultSet.getTimestamp("ts_fecha_actualizacion"));
                predio.setFechaBaja(resultSet.getTimestamp("ts_fecha_baja"));
                predio.setEstadoLogico(resultSet.getString("ch_estado_logico"));
                predio.setPorcentajeExcencion(resultSet.getDouble("db_porcent_excep"));
                predio.setExcencionEspecial(resultSet.getString("chv_excencion_esp"));
                predio.setSectorHomogeneo(FSectorHomogeneo.obtenerSectorHomogeneoDadoCodigo(resultSet.getInt("id_sector_homogeneo")));
                predio.setSessionUsuario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("id_session_usuario")));
                predio.setPlanimetria(resultSet.getString("planimetria"));
                lst.add(predio);
            }
        } catch (Exception e) {
            throw e;
        }
        return lst;
    }

    public static String editarPredio(PredioV2 predio) throws Exception {
        String band;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "select * from catastro.f_editar_predio_v2(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setInt(1, predio.getNumFicha());
            prstm.setInt(2, predio.getIdParroquia().getIdParroquia());
            prstm.setInt(3, predio.getZona());
            prstm.setInt(4, predio.getSector());
            prstm.setInt(5, predio.getManzana());
            prstm.setInt(6, predio.getNumPredio());
            prstm.setInt(7, predio.getPropHorBloque());
            prstm.setInt(8, predio.getPropHorPiso());
            prstm.setInt(9, predio.getPropHorUnidad());
            prstm.setString(10, predio.getClaveCatastral());
            prstm.setString(11, predio.getClaveCatastralAnt());
            prstm.setString(12, predio.getBarrio());
            prstm.setString(13, predio.getCallePrinc());
            prstm.setString(14, predio.getCalleSecund());
            prstm.setString(15, predio.getNumCasa());
            prstm.setString(16, predio.getNombreEdificio());
            prstm.setInt(17, predio.getPropietario().getIdPersona());
            prstm.setInt(18, predio.getRepLegal().getIdPersona());
            prstm.setInt(19, predio.getDominio().getIdDominio());
            prstm.setString(20, predio.getCondicion());
            prstm.setString(21, predio.getFormaAdq());
            prstm.setString(22, predio.getNotaria());
            prstm.setDate(23, new java.sql.Date(predio.getFechaTituloProp().getTime()));
            prstm.setDate(24, new java.sql.Date(predio.getFechaRegistroPredio().getTime()));
            prstm.setDouble(25, predio.getAreaEscritura());
            prstm.setString(26, predio.getPropAnterior());
            prstm.setDouble(27, predio.getAvaluoProp());
            prstm.setString(28, predio.getUsoSueloGestion());
            prstm.setString(29, predio.getUsoSueloConsumo());
            prstm.setString(30, predio.getUsoSuelIntercambio());
            prstm.setString(31, predio.getUsoSuelProduc());
            prstm.setString(32, predio.getOcupacionPredio());
            prstm.setString(33, predio.getLocalizacionPredio());
            prstm.setString(34, predio.getTopografiaPredio());
            prstm.setString(35, predio.getFormaPredio());
            prstm.setString(36, predio.getCaracteristSuelo());
            prstm.setString(37, predio.getUsoVias());
            prstm.setString(38, predio.getMaterialVias());
            prstm.setString(39, predio.getRedAgua());
            prstm.setString(40, predio.getAlcantarillado());
            prstm.setString(41, predio.getEnergElectric());
            prstm.setString(42, predio.getRedTelefon());
            prstm.setString(43, predio.getRecBasura());
            prstm.setString(44, predio.getTranspPublico());
            prstm.setString(45, predio.getInternet());
            prstm.setString(46, predio.getOtrosServicios());
            prstm.setDouble(47, predio.getAreaConstruc());
            prstm.setDouble(48, predio.getAreaTotalConst());
            prstm.setDouble(49, predio.getAreaTotalTerreno());
            prstm.setString(50, predio.getPatio());
            prstm.setString(51, predio.getPiscina());
            prstm.setString(52, predio.getCerramiento());
            prstm.setString(53, predio.getCisterna());
            prstm.setString(54, predio.getMuros());
            prstm.setString(55, predio.getAscensor());
            prstm.setInt(56, predio.getNumBanios());
            prstm.setDouble(57, predio.getLinderoFrente1());
            prstm.setDouble(58, predio.getLinderoFrente2());
            prstm.setDouble(59, predio.getLinderoFrente3());
            prstm.setDouble(60, predio.getLinderoFrente4());
            prstm.setString(61, predio.getLinderoCalle1());
            prstm.setString(62, predio.getLinderoCalle2());
            prstm.setString(63, predio.getLinderoCalle3());
            prstm.setString(64, predio.getLinderoCalle4());
            prstm.setDouble(65, predio.getLinderoAlicuota1());
            prstm.setDouble(66, predio.getLinderoAlicuota2());
            prstm.setDouble(67, predio.getLinderoAlicuota3());
            prstm.setDouble(68, predio.getLinderoAlicuota4());
            prstm.setDouble(69, predio.getDerechosAcciones());
            prstm.setString(70, predio.getCroquis());
            prstm.setString(71, predio.getEmplazamiento());
            prstm.setString(72, predio.getFotografia());
            prstm.setString(73, predio.getTopografiaRefTopog());
            prstm.setString(74, predio.getFotoAerea());
            prstm.setString(75, predio.getOtraRefTopog());
            prstm.setDouble(76, predio.getCoordenadaE());
            prstm.setDouble(77, predio.getCoordenadaN());
            prstm.setString(78, predio.getColindantNorte());
            prstm.setString(79, predio.getColindantEste());
            prstm.setString(80, predio.getColindantSur());
            prstm.setString(81, predio.getColindantOeste());
            prstm.setString(82, predio.getFuenteInformante());
            prstm.setString(83, predio.getTelfInformante());
            prstm.setString(84, predio.getFichaAdjunta());
            prstm.setDouble(85, predio.getPorcentajeExcencion());
            prstm.setString(86, predio.getExcencionEspecial());
            prstm.setString(87, predio.getObservaciones());
            prstm.setInt(88, 1);
            prstm.setInt(89, predio.getSessionUsuario().getIdPersona());
            prstm.setBoolean(90, predio.getLegalizado());
            prstm.setString(91, predio.getSustentoUpdate());
            prstm.setInt(92, predio.getIdPredio());
            resultSet = accesoDatos.ejecutaPrepared(prstm);
            if (resultSet.next()) {
                band = resultSet.getString(1);
                return band;
            } else {
                return null;
            }
        } catch (Exception e) {
            throw e;
        }
    }

    public static ArrayList<PredioV2> encontrarPrediosDadoZonaSectorManzana(int zona, int sector, int manzana, int numPredio) throws Exception {
        ArrayList<PredioV2> lst = new ArrayList<>();
        PredioV2 predio;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "SELECT * FROM catastro.f_buscar_predios_dado_zona_sector(?,?,?,?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setInt(1, zona);
            prstm.setInt(2, sector);
            prstm.setInt(3, manzana);
            prstm.setInt(4, numPredio);
            resultSet = accesoDatos.ejecutaPrepared(prstm);
            while (resultSet.next()) {
                predio = new PredioV2();
                predio.setIdParroquia(new Parroquia());
                predio.setPropietario(new Usuario());
                predio.setRepLegal(new Usuario());
                predio.setDominio(new Dominio());
                predio.setIdPredio(resultSet.getInt("int_id_predio"));
                predio.setNumFicha(resultSet.getInt("int_num_ficha"));
                predio.setIdParroquia(ServiciosParroquia.obtenerParroquiaDadoCodigo(resultSet.getInt("int_id_parroquia")));
                predio.setZona(resultSet.getInt("int_zona"));
                predio.setSector(resultSet.getInt("int_sector"));
                predio.setManzana(resultSet.getInt("int_manzana"));
                predio.setNumPredio(resultSet.getInt("int_num_predio"));
                predio.setPropHorBloque(resultSet.getInt("int_prop_hor_bloque"));
                predio.setPropHorPiso(resultSet.getInt("int_prop_hor_piso"));
                predio.setPropHorUnidad(resultSet.getInt("int_prop_hor_unidad"));
                predio.setClaveCatastral(resultSet.getString("chv_clave_catastral"));
                predio.setClaveCatastralAnt(resultSet.getString("chv_clave_catastral_ant"));
                predio.setBarrio(resultSet.getString("chv_barrio"));
                predio.setCallePrinc(resultSet.getString("chv_calle_princ"));
                predio.setCalleSecund(resultSet.getString("chv_calle_secund"));
                predio.setNumCasa(resultSet.getString("chv_num_casa"));
                predio.setNombreEdificio(resultSet.getString("chv_nombre_edificio"));
                predio.setPropietario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_titular_dom")));
                predio.setRepLegal(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_rep_legal")));
                predio.setDominio(ServiciosDominio.obtenerDominioDadoCodigo(resultSet.getInt("int_id_dominio")));
                predio.setCondicion(resultSet.getString("chv_condicion"));
                predio.setFormaAdq(resultSet.getString("chv_forma_adq"));
                predio.setNotaria(resultSet.getString("chv_notaria"));
                predio.setFechaTituloProp(resultSet.getDate("dt_fecha_titulo_prop"));
                predio.setFechaRegistroPredio(resultSet.getDate("dt_fecha_registro"));
                predio.setAreaEscritura(resultSet.getDouble("db_area_escritura"));
                predio.setPropAnterior(resultSet.getString("chv_prop_anterior"));
                predio.setAvaluoProp(resultSet.getDouble("db_avaluo_prop"));
                predio.setUsoSueloGestion(resultSet.getString("chv_gest_uso_suelo"));
                predio.setUsoSueloConsumo(resultSet.getString("chv_uso_suelo_consumo"));
                predio.setUsoSuelIntercambio(resultSet.getString("chv_us_suel_intercambio"));
                predio.setUsoSuelProduc(resultSet.getString("chv_us_suel_produc"));
                predio.setOcupacionPredio(resultSet.getString("chv_ocupacion_predio"));
                predio.setLocalizacionPredio(resultSet.getString("chv_localizacion_predio"));
                predio.setTopografiaPredio(resultSet.getString("chv_topografia_pedio"));
                predio.setFormaPredio(resultSet.getString("chv_forma_predio"));
                predio.setCaracteristSuelo(resultSet.getString("chv_caract_suelo"));
                predio.setUsoVias(resultSet.getString("chv_uso_vias"));
                predio.setMaterialVias(resultSet.getString("chv_material_vias"));
                predio.setRedAgua(resultSet.getString("chv_red_agua"));
                predio.setAlcantarillado(resultSet.getString("chv_alcantarillado"));
                predio.setEnergElectric(resultSet.getString("chv_energ_electric"));
                predio.setRedTelefon(resultSet.getString("chv_red_telefon"));
                predio.setRecBasura(resultSet.getString("chv_rec_basura"));
                predio.setTranspPublico(resultSet.getString("chv_transp_publico"));
                predio.setInternet(resultSet.getString("chv_internet"));
                predio.setOtrosServicios(resultSet.getString("chv_otros_servicios"));
                predio.setAreaConstruc(resultSet.getDouble("db_area_construc"));
                predio.setAreaTotalConst(resultSet.getDouble("db_area_total_const"));
                predio.setAreaTotalTerreno(resultSet.getDouble("db_area_total_terreno"));
                predio.setPatio(resultSet.getString("chv_patio"));
                predio.setPiscina(resultSet.getString("chv_piscina"));
                predio.setCerramiento(resultSet.getString("chv_cerramiento"));
                predio.setCisterna(resultSet.getString("chv_cisterna"));
                predio.setMuros(resultSet.getString("chv_muros"));
                predio.setAscensor(resultSet.getString("chv_ascensor"));
                predio.setNumBanios(resultSet.getInt("int_num_banios"));
                predio.setLinderoFrente1(resultSet.getDouble("db_lindero_frente1"));
                predio.setLinderoFrente2(resultSet.getDouble("db_lindero_frente2"));
                predio.setLinderoFrente3(resultSet.getDouble("db_lindero_frente3"));
                predio.setLinderoFrente4(resultSet.getDouble("db_lindero_frente4"));
                predio.setLinderoCalle1(resultSet.getString("chv_lindero_calle1"));
                predio.setLinderoCalle2(resultSet.getString("chv_lindero_calle2"));
                predio.setLinderoCalle3(resultSet.getString("chv_lindero_calle3"));
                predio.setLinderoCalle4(resultSet.getString("chv_lindero_calle4"));
                predio.setLinderoAlicuota1(resultSet.getDouble("db_lindero_alicuota1"));
                predio.setLinderoAlicuota2(resultSet.getDouble("db_lindero_alicuota2"));
                predio.setLinderoAlicuota3(resultSet.getDouble("db_lindero_alicuota3"));
                predio.setLinderoAlicuota4(resultSet.getDouble("db_lindero_alicuota4"));
                predio.setCroquis(resultSet.getString("chv_croquis"));
                predio.setEmplazamiento(resultSet.getString("chv_emplazamiento"));
                predio.setFotografia(resultSet.getString("chv_fotografia"));
                predio.setTopografiaRefTopog(resultSet.getString("chv_topografia_ref_top"));
                predio.setFotoAerea(resultSet.getString("chv_foto_aerea"));
                predio.setOtraRefTopog(resultSet.getString("chv_otra_ref_top"));
                predio.setCoordenadaE(resultSet.getDouble("db_coord_e"));
                predio.setCoordenadaN(resultSet.getDouble("db_coord_n"));
                predio.setColindantNorte(resultSet.getString("chv_colindant_nort"));
                predio.setColindantEste(resultSet.getString("chv_colindant_este"));
                predio.setColindantSur(resultSet.getString("chv_colindant_sur"));
                predio.setColindantOeste(resultSet.getString("chv_colindant_oest"));
                predio.setFuenteInformante(resultSet.getString("chv_fuente_informant"));
                predio.setTelfInformante(resultSet.getString("chv_telf_informant"));
                predio.setFichaAdjunta(resultSet.getString("chv_ficha_adjunta"));
                predio.setFechaRegistro(resultSet.getTimestamp("ts_fecha_registro"));
                predio.setFechaActualizacion(resultSet.getTimestamp("ts_fecha_actualizacion"));
                predio.setFechaBaja(resultSet.getTimestamp("ts_fecha_baja"));
                predio.setEstadoLogico(resultSet.getString("ch_estado_logico"));
                predio.setPorcentajeExcencion(resultSet.getDouble("db_porcent_excep"));
                predio.setExcencionEspecial(resultSet.getString("chv_excencion_esp"));
                predio.setSectorHomogeneo(FSectorHomogeneo.obtenerSectorHomogeneoDadoCodigo(resultSet.getInt("id_sector_homogeneo")));
                predio.setSessionUsuario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("id_session_usuario")));
                predio.setPlanimetria(resultSet.getString("planimetria"));
                predio.setSustentoUpdate(resultSet.getString("txt_sustento_update"));
                predio.setSustentoDelete(resultSet.getString("txt_sustento_delete"));
                predio.setObservaciones(resultSet.getString("chv_observaciones"));
                lst.add(predio);
            }
        } catch (Exception e) {
            throw e;
        }
        return lst;
    }

    public static ArrayList<PredioV2> encontrarPrediosDesdeHasta(int zonaInicio,
            int zonaFin,
            int sectorInicio,
            int sectorFin,
            int manzanaInicio,
            int manzanaFin,
            int numPredioInicio,
            int numPredioFin) throws Exception {
        ArrayList<PredioV2> lst = new ArrayList<>();
        PredioV2 predio;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "SELECT * FROM catastro.f_obtener_predios_desde_hasta(?,?,?,?,?,?,?,?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setInt(1, zonaInicio);
            prstm.setInt(2, zonaFin);
            prstm.setInt(3, sectorInicio);
            prstm.setInt(4, sectorFin);
            prstm.setInt(5, manzanaInicio);
            prstm.setInt(6, manzanaFin);
            prstm.setInt(7, numPredioInicio);
            prstm.setInt(8, numPredioFin);
            resultSet = accesoDatos.ejecutaPrepared(prstm);
            while (resultSet.next()) {
                predio = new PredioV2();
                predio.setIdParroquia(new Parroquia());
                predio.setPropietario(new Usuario());
                predio.setRepLegal(new Usuario());
                predio.setDominio(new Dominio());
                predio.setIdPredio(resultSet.getInt("int_id_predio"));
                predio.setNumFicha(resultSet.getInt("int_num_ficha"));
                predio.setIdParroquia(ServiciosParroquia.obtenerParroquiaDadoCodigo(resultSet.getInt("int_id_parroquia")));
                predio.setZona(resultSet.getInt("int_zona"));
                predio.setSector(resultSet.getInt("int_sector"));
                predio.setManzana(resultSet.getInt("int_manzana"));
                predio.setNumPredio(resultSet.getInt("int_num_predio"));
                predio.setPropHorBloque(resultSet.getInt("int_prop_hor_bloque"));
                predio.setPropHorPiso(resultSet.getInt("int_prop_hor_piso"));
                predio.setPropHorUnidad(resultSet.getInt("int_prop_hor_unidad"));
                predio.setClaveCatastral(resultSet.getString("chv_clave_catastral"));
                predio.setClaveCatastralAnt(resultSet.getString("chv_clave_catastral_ant"));
                predio.setBarrio(resultSet.getString("chv_barrio"));
                predio.setCallePrinc(resultSet.getString("chv_calle_princ"));
                predio.setCalleSecund(resultSet.getString("chv_calle_secund"));
                predio.setNumCasa(resultSet.getString("chv_num_casa"));
                predio.setNombreEdificio(resultSet.getString("chv_nombre_edificio"));
                predio.setPropietario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_titular_dom")));
                predio.setRepLegal(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_rep_legal")));
                predio.setDominio(ServiciosDominio.obtenerDominioDadoCodigo(resultSet.getInt("int_id_dominio")));
                predio.setCondicion(resultSet.getString("chv_condicion"));
                predio.setFormaAdq(resultSet.getString("chv_forma_adq"));
                predio.setNotaria(resultSet.getString("chv_notaria"));
                predio.setFechaTituloProp(resultSet.getDate("dt_fecha_titulo_prop"));
                predio.setFechaRegistroPredio(resultSet.getDate("dt_fecha_registro"));
                predio.setAreaEscritura(resultSet.getDouble("db_area_escritura"));
                predio.setPropAnterior(resultSet.getString("chv_prop_anterior"));
                predio.setAvaluoProp(resultSet.getDouble("db_avaluo_prop"));
                predio.setUsoSueloGestion(resultSet.getString("chv_gest_uso_suelo"));
                predio.setUsoSueloConsumo(resultSet.getString("chv_uso_suelo_consumo"));
                predio.setUsoSuelIntercambio(resultSet.getString("chv_us_suel_intercambio"));
                predio.setUsoSuelProduc(resultSet.getString("chv_us_suel_produc"));
                predio.setOcupacionPredio(resultSet.getString("chv_ocupacion_predio"));
                predio.setLocalizacionPredio(resultSet.getString("chv_localizacion_predio"));
                predio.setTopografiaPredio(resultSet.getString("chv_topografia_pedio"));
                predio.setFormaPredio(resultSet.getString("chv_forma_predio"));
                predio.setCaracteristSuelo(resultSet.getString("chv_caract_suelo"));
                predio.setUsoVias(resultSet.getString("chv_uso_vias"));
                predio.setMaterialVias(resultSet.getString("chv_material_vias"));
                predio.setRedAgua(resultSet.getString("chv_red_agua"));
                predio.setAlcantarillado(resultSet.getString("chv_alcantarillado"));
                predio.setEnergElectric(resultSet.getString("chv_energ_electric"));
                predio.setRedTelefon(resultSet.getString("chv_red_telefon"));
                predio.setRecBasura(resultSet.getString("chv_rec_basura"));
                predio.setTranspPublico(resultSet.getString("chv_transp_publico"));
                predio.setInternet(resultSet.getString("chv_internet"));
                predio.setOtrosServicios(resultSet.getString("chv_otros_servicios"));
                predio.setAreaConstruc(resultSet.getDouble("db_area_construc"));
                predio.setAreaTotalConst(resultSet.getDouble("db_area_total_const"));
                predio.setAreaTotalTerreno(resultSet.getDouble("db_area_total_terreno"));
                predio.setPatio(resultSet.getString("chv_patio"));
                predio.setPiscina(resultSet.getString("chv_piscina"));
                predio.setCerramiento(resultSet.getString("chv_cerramiento"));
                predio.setCisterna(resultSet.getString("chv_cisterna"));
                predio.setMuros(resultSet.getString("chv_muros"));
                predio.setAscensor(resultSet.getString("chv_ascensor"));
                predio.setNumBanios(resultSet.getInt("int_num_banios"));
                predio.setLinderoFrente1(resultSet.getDouble("db_lindero_frente1"));
                predio.setLinderoFrente2(resultSet.getDouble("db_lindero_frente2"));
                predio.setLinderoFrente3(resultSet.getDouble("db_lindero_frente3"));
                predio.setLinderoFrente4(resultSet.getDouble("db_lindero_frente4"));
                predio.setLinderoCalle1(resultSet.getString("chv_lindero_calle1"));
                predio.setLinderoCalle2(resultSet.getString("chv_lindero_calle2"));
                predio.setLinderoCalle3(resultSet.getString("chv_lindero_calle3"));
                predio.setLinderoCalle4(resultSet.getString("chv_lindero_calle4"));
                predio.setLinderoAlicuota1(resultSet.getDouble("db_lindero_alicuota1"));
                predio.setLinderoAlicuota2(resultSet.getDouble("db_lindero_alicuota2"));
                predio.setLinderoAlicuota3(resultSet.getDouble("db_lindero_alicuota3"));
                predio.setLinderoAlicuota4(resultSet.getDouble("db_lindero_alicuota4"));
                predio.setCroquis(resultSet.getString("chv_croquis"));
                predio.setEmplazamiento(resultSet.getString("chv_emplazamiento"));
                predio.setFotografia(resultSet.getString("chv_fotografia"));
                predio.setTopografiaRefTopog(resultSet.getString("chv_topografia_ref_top"));
                predio.setFotoAerea(resultSet.getString("chv_foto_aerea"));
                predio.setOtraRefTopog(resultSet.getString("chv_otra_ref_top"));
                predio.setCoordenadaE(resultSet.getDouble("db_coord_e"));
                predio.setCoordenadaN(resultSet.getDouble("db_coord_n"));
                predio.setColindantNorte(resultSet.getString("chv_colindant_nort"));
                predio.setColindantEste(resultSet.getString("chv_colindant_este"));
                predio.setColindantSur(resultSet.getString("chv_colindant_sur"));
                predio.setColindantOeste(resultSet.getString("chv_colindant_oest"));
                predio.setFuenteInformante(resultSet.getString("chv_fuente_informant"));
                predio.setTelfInformante(resultSet.getString("chv_telf_informant"));
                predio.setFichaAdjunta(resultSet.getString("chv_ficha_adjunta"));
                predio.setFechaRegistro(resultSet.getTimestamp("ts_fecha_registro"));
                predio.setFechaActualizacion(resultSet.getTimestamp("ts_fecha_actualizacion"));
                predio.setFechaBaja(resultSet.getTimestamp("ts_fecha_baja"));
                predio.setEstadoLogico(resultSet.getString("ch_estado_logico"));
                predio.setPorcentajeExcencion(resultSet.getDouble("db_porcent_excep"));
                predio.setExcencionEspecial(resultSet.getString("chv_excencion_esp"));
                predio.setSectorHomogeneo(FSectorHomogeneo.obtenerSectorHomogeneoDadoCodigo(resultSet.getInt("id_sector_homogeneo")));
                predio.setSessionUsuario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("id_session_usuario")));
                predio.setPlanimetria(resultSet.getString("planimetria"));
                predio.setSustentoUpdate(resultSet.getString("txt_sustento_update"));
                predio.setSustentoDelete(resultSet.getString("txt_sustento_delete"));
                predio.setObservaciones(resultSet.getString("chv_observaciones"));
                lst.add(predio);
            }
        } catch (Exception e) {
            throw e;
        }
        return lst;
    }

    public static ArrayList<PredioV2> encontrarPrediosDadoClaveAnterior(int zona, int sector, int manzana, int numPredio, int propAnt, int derAcc) throws Exception {
        ArrayList<PredioV2> lst = new ArrayList<>();
        PredioV2 predio;
        AccesoDatos accesoDatos;
        String sql;
        PreparedStatement prstm;
        ResultSet resultSet;
        try {
            accesoDatos = new AccesoDatos();
            sql = "SELECT * FROM catastro.f_encontrar_predios_por_clave_anterior_v2(?,?,?,?,?,?)";
            prstm = accesoDatos.creaPreparedSmt(sql);
            prstm.setInt(1, zona);
            prstm.setInt(2, sector);
            prstm.setInt(3, manzana);
            prstm.setInt(4, numPredio);
            prstm.setInt(5, propAnt);
            prstm.setInt(6, derAcc);
            resultSet = accesoDatos.ejecutaPrepared(prstm);
            while (resultSet.next()) {
                predio = new PredioV2();
                predio.setIdParroquia(new Parroquia());
                predio.setPropietario(new Usuario());
                predio.setRepLegal(new Usuario());
                predio.setDominio(new Dominio());
                predio.setIdPredio(resultSet.getInt("int_id_predio"));
                predio.setNumFicha(resultSet.getInt("int_num_ficha"));
                predio.setIdParroquia(ServiciosParroquia.obtenerParroquiaDadoCodigo(resultSet.getInt("int_id_parroquia")));
                predio.setZona(resultSet.getInt("int_zona"));
                predio.setSector(resultSet.getInt("int_sector"));
                predio.setManzana(resultSet.getInt("int_manzana"));
                predio.setNumPredio(resultSet.getInt("int_num_predio"));
                predio.setPropHorBloque(resultSet.getInt("int_prop_hor_bloque"));
                predio.setPropHorPiso(resultSet.getInt("int_prop_hor_piso"));
                predio.setPropHorUnidad(resultSet.getInt("int_prop_hor_unidad"));
                predio.setClaveCatastral(resultSet.getString("chv_clave_catastral"));
                predio.setClaveCatastralAnt(resultSet.getString("chv_clave_catastral_ant"));
                predio.setBarrio(resultSet.getString("chv_barrio"));
                predio.setCallePrinc(resultSet.getString("chv_calle_princ"));
                predio.setCalleSecund(resultSet.getString("chv_calle_secund"));
                predio.setNumCasa(resultSet.getString("chv_num_casa"));
                predio.setNombreEdificio(resultSet.getString("chv_nombre_edificio"));
                predio.setPropietario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_titular_dom")));
                predio.setRepLegal(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("int_id_rep_legal")));
                predio.setDominio(ServiciosDominio.obtenerDominioDadoCodigo(resultSet.getInt("int_id_dominio")));
                predio.setCondicion(resultSet.getString("chv_condicion"));
                predio.setFormaAdq(resultSet.getString("chv_forma_adq"));
                predio.setNotaria(resultSet.getString("chv_notaria"));
                predio.setFechaTituloProp(resultSet.getDate("dt_fecha_titulo_prop"));
                predio.setFechaRegistroPredio(resultSet.getDate("dt_fecha_registro"));
                predio.setAreaEscritura(resultSet.getDouble("db_area_escritura"));
                predio.setPropAnterior(resultSet.getString("chv_prop_anterior"));
                predio.setAvaluoProp(resultSet.getDouble("db_avaluo_prop"));
                predio.setUsoSueloGestion(resultSet.getString("chv_gest_uso_suelo"));
                predio.setUsoSueloConsumo(resultSet.getString("chv_uso_suelo_consumo"));
                predio.setUsoSuelIntercambio(resultSet.getString("chv_us_suel_intercambio"));
                predio.setUsoSuelProduc(resultSet.getString("chv_us_suel_produc"));
                predio.setOcupacionPredio(resultSet.getString("chv_ocupacion_predio"));
                predio.setLocalizacionPredio(resultSet.getString("chv_localizacion_predio"));
                predio.setTopografiaPredio(resultSet.getString("chv_topografia_pedio"));
                predio.setFormaPredio(resultSet.getString("chv_forma_predio"));
                predio.setCaracteristSuelo(resultSet.getString("chv_caract_suelo"));
                predio.setUsoVias(resultSet.getString("chv_uso_vias"));
                predio.setMaterialVias(resultSet.getString("chv_material_vias"));
                predio.setRedAgua(resultSet.getString("chv_red_agua"));
                predio.setAlcantarillado(resultSet.getString("chv_alcantarillado"));
                predio.setEnergElectric(resultSet.getString("chv_energ_electric"));
                predio.setRedTelefon(resultSet.getString("chv_red_telefon"));
                predio.setRecBasura(resultSet.getString("chv_rec_basura"));
                predio.setTranspPublico(resultSet.getString("chv_transp_publico"));
                predio.setInternet(resultSet.getString("chv_internet"));
                predio.setOtrosServicios(resultSet.getString("chv_otros_servicios"));
                predio.setAreaConstruc(resultSet.getDouble("db_area_construc"));
                predio.setAreaTotalConst(resultSet.getDouble("db_area_total_const"));
                predio.setAreaTotalTerreno(resultSet.getDouble("db_area_total_terreno"));
                predio.setPatio(resultSet.getString("chv_patio"));
                predio.setPiscina(resultSet.getString("chv_piscina"));
                predio.setCerramiento(resultSet.getString("chv_cerramiento"));
                predio.setCisterna(resultSet.getString("chv_cisterna"));
                predio.setMuros(resultSet.getString("chv_muros"));
                predio.setAscensor(resultSet.getString("chv_ascensor"));
                predio.setNumBanios(resultSet.getInt("int_num_banios"));
                predio.setLinderoFrente1(resultSet.getDouble("db_lindero_frente1"));
                predio.setLinderoFrente2(resultSet.getDouble("db_lindero_frente2"));
                predio.setLinderoFrente3(resultSet.getDouble("db_lindero_frente3"));
                predio.setLinderoFrente4(resultSet.getDouble("db_lindero_frente4"));
                predio.setLinderoCalle1(resultSet.getString("chv_lindero_calle1"));
                predio.setLinderoCalle2(resultSet.getString("chv_lindero_calle2"));
                predio.setLinderoCalle3(resultSet.getString("chv_lindero_calle3"));
                predio.setLinderoCalle4(resultSet.getString("chv_lindero_calle4"));
                predio.setLinderoAlicuota1(resultSet.getDouble("db_lindero_alicuota1"));
                predio.setLinderoAlicuota2(resultSet.getDouble("db_lindero_alicuota2"));
                predio.setLinderoAlicuota3(resultSet.getDouble("db_lindero_alicuota3"));
                predio.setLinderoAlicuota4(resultSet.getDouble("db_lindero_alicuota4"));
                predio.setCroquis(resultSet.getString("chv_croquis"));
                predio.setEmplazamiento(resultSet.getString("chv_emplazamiento"));
                predio.setFotografia(resultSet.getString("chv_fotografia"));
                predio.setTopografiaRefTopog(resultSet.getString("chv_topografia_ref_top"));
                predio.setFotoAerea(resultSet.getString("chv_foto_aerea"));
                predio.setOtraRefTopog(resultSet.getString("chv_otra_ref_top"));
                predio.setCoordenadaE(resultSet.getDouble("db_coord_e"));
                predio.setCoordenadaN(resultSet.getDouble("db_coord_n"));
                predio.setColindantNorte(resultSet.getString("chv_colindant_nort"));
                predio.setColindantEste(resultSet.getString("chv_colindant_este"));
                predio.setColindantSur(resultSet.getString("chv_colindant_sur"));
                predio.setColindantOeste(resultSet.getString("chv_colindant_oest"));
                predio.setFuenteInformante(resultSet.getString("chv_fuente_informant"));
                predio.setTelfInformante(resultSet.getString("chv_telf_informant"));
                predio.setFichaAdjunta(resultSet.getString("chv_ficha_adjunta"));
                predio.setFechaRegistro(resultSet.getTimestamp("ts_fecha_registro"));
                predio.setFechaActualizacion(resultSet.getTimestamp("ts_fecha_actualizacion"));
                predio.setFechaBaja(resultSet.getTimestamp("ts_fecha_baja"));
                predio.setEstadoLogico(resultSet.getString("ch_estado_logico"));
                predio.setPorcentajeExcencion(resultSet.getDouble("db_porcent_excep"));
                predio.setExcencionEspecial(resultSet.getString("chv_excencion_esp"));
//                predio.setSectorHomogeneo(FSectorHomogeneo.obtenerSectorHomogeneoDadoCodigo(resultSet.getInt("id_sector_homogeneo")));
//                predio.setSessionUsuario(ServiciosUsuario.buscarUsuarioDadoId(resultSet.getInt("id_session_usuario")));
                predio.setPlanimetria(resultSet.getString("planimetria"));
                predio.setSustentoUpdate(resultSet.getString("txt_sustento_update"));
                predio.setSustentoDelete(resultSet.getString("txt_sustento_delete"));
                predio.setObservaciones(resultSet.getString("chv_observaciones"));
                lst.add(predio);
            }
        } catch (Exception e) {
            throw e;
        }
        return lst;
    }

}
